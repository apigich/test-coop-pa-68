<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <style>
    body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; overflow-x: hidden; display: flex; flex-direction: column; min-height: 100vh; font-size: 0.95rem; }
    .container-fluid, .row { padding: 0 !important; margin: 0 !important; width: 100% !important; max-width: 100% !important; }

    /* Header */
    .main-header { position: relative; background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Doi_Suthep_02.jpg/1200px-Doi_Suthep_02.jpg') center center/cover no-repeat; color: white; padding: 70px 0; margin-bottom: 0; }
    .header-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, rgba(13, 110, 253, 0.9) 0%, rgba(0, 50, 133, 0.7) 100%); z-index: 1; }
    .header-content { position: relative; z-index: 2; padding: 0 40px; }
    .header-icon { font-size: 3.5rem; text-shadow: 0 4px 6px rgba(0,0,0,0.3); } 
    .org-name { font-size: 1.6rem; font-weight: 700; line-height: 1.3; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
    .org-sub { font-size: 1rem; opacity: 0.9; margin-top: 8px; font-weight: 300; letter-spacing: 0.5px; text-transform: uppercase; }

    @media (max-width: 768px) {
      .main-header { padding: 40px 0; }
      .org-name { font-size: 1.25rem; }
      .header-icon { font-size: 3rem; }
      .header-content { padding: 0 20px; text-align: center; display: block !important; }
      .header-icon-box { margin-bottom: 15px; display: block; }
    }

    /* Sidebar Layout */
    .sidebar { min-height: 100vh; height: 100%; border-right: 1px solid #e9ecef; padding-top: 20px; background: white; }
    
    .nav-link-main { 
      font-weight: 700; color: #0d6efd; padding: 12px 20px; cursor: pointer; display: block;
      border-left: 4px solid transparent; transition: 0.2s; font-size: 1rem; text-decoration: none;
    }
    .nav-link-main:hover { background-color: #f8f9fa; color: #0a58ca; }
    .nav-link-main.active { background-color: #e7f1ff; border-left-color: #0d6efd; color: #0d6efd; }

    .nav-link-sub { 
      font-weight: 400; color: #6c757d; padding: 8px 20px 8px 45px; cursor: pointer; display: block;
      font-size: 0.9rem; transition: 0.2s; position: relative; text-decoration: none;
    }
    .nav-link-sub:hover { color: #0d6efd; background-color: #f8f9fa; transform: translateX(3px); }
    .nav-link-sub::before { 
      content: ""; position: absolute; left: 25px; top: 50%; width: 10px; height: 1px; 
      background-color: #dee2e6; transform: translateY(-50%);
    }

    /* Content */
    .main-content-wrapper { padding: 30px; }
    .content-section { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.04); margin-bottom: 25px; border: 1px solid #fff; }
    .section-header { padding-bottom: 10px; margin-bottom: 20px; color: #0d6efd; font-weight: 700; font-size: 1.3rem; border-bottom: none; }
    .form-control, .form-select { border-radius: 8px; padding: 10px 15px; border: 1px solid #ced4da; }
    .form-control:focus, .form-select:focus { box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.15); border-color: #0d6efd; }

    /* Calendar Styles */
    .calendar-container { width: 100%; border: 1px solid #dee2e6; border-radius: 10px; overflow: hidden; background: #fff; }
    .calendar-header { display: flex; justify-content: space-between; align-items: center; background: #0d6efd; color: white; padding: 15px; }
    .btn-nav { background: rgba(255,255,255,0.2); border: none; color: white; border-radius: 50%; width: 35px; height: 35px; cursor: pointer; transition: 0.2s; }
    .btn-nav:hover { background: rgba(255,255,255,0.4); }
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); }
    .day-name { background: #f8f9fa; text-align: center; font-weight: bold; padding: 10px; border-bottom: 1px solid #dee2e6; border-right: 1px solid #dee2e6; color: #6c757d; }
    .day-cell { min-height: 100px; border-bottom: 1px solid #dee2e6; border-right: 1px solid #dee2e6; padding: 5px; position: relative; background: white; }
    .day-cell:hover { background-color: #f8f9fa; }
    .day-cell.today { background-color: #e7f1ff; }
    .day-number { font-weight: bold; font-size: 0.9rem; margin-bottom: 5px; display: inline-block; width: 25px; height: 25px; text-align: center; line-height: 25px; border-radius: 50%; }
    .day-cell.today .day-number { background: #0d6efd; color: white; }
    .day-cell.other-month { background-color: #fdfdfd; color: #ccc; }
    
    .event-badge { 
      display: block; font-size: 0.75rem; padding: 3px 20px 3px 8px; 
      margin-bottom: 3px; border-radius: 4px; color: white; text-decoration: none; 
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; cursor: pointer; position: relative;
      opacity: 0.9; transition: 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.1); z-index: 5;
    }
    .event-badge:hover { opacity: 1; transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    
    .delete-event-btn { 
      position: absolute; right: 2px; top: 50%; transform: translateY(-50%); 
      color: white; font-weight: bold; cursor: pointer; font-size: 10px; 
      padding: 0; border-radius: 50%; background: rgba(0,0,0,0.3); 
      display: none; width: 18px; height: 18px; text-align: center; line-height: 18px; 
      z-index: 10; 
    }
    .delete-event-btn:hover { background: rgba(255,0,0,0.7); }

    .admin-controls { display: none; background: #fff3cd; border: 1px solid #ffeeba; padding: 20px; border-radius: 10px; margin-bottom: 20px; }

    /* Footer */
    .main-footer { background-color: #1a1d20; color: #cfd2d6; padding: 100px 40px 120px 40px; margin-top: auto; border-top: none; width: 100%; }
    .main-footer h5 { color: white; font-weight: 700; margin-bottom: 20px; border-left: 4px solid #0d6efd; padding-left: 10px; line-height: 1.6; margin-top: 0; }
    .admin-trigger { cursor: pointer; opacity: 0.3; transition: 0.3s; }
    .admin-trigger:hover { opacity: 1; color: #ffc107; }
    .map-container { border-radius: 10px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.3); border: 2px solid #343a40; }

    @media (max-width: 768px) {
      .sidebar { position: static; height: auto; border-right: none; }
      .day-cell { min-height: 60px; }
      .main-footer { padding: 60px 20px 80px 20px; }
    }
  </style>
</head>
<body onload="initSystem()">

  <header class="main-header container-fluid p-0">
    <div class="header-overlay"></div>
    <div class="header-content d-flex align-items-center">
      <div class="me-4 header-icon-box"><span class="header-icon">üèõÔ∏è</span></div> 
      <div>
        <h1 class="m-0 org-name">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</h1>
        <div class="org-sub">Strategy and Information for Provincial Development</div>
      </div>
    </div>
  </header>

  <div class="container-fluid p-0 flex-grow-1">
    <div class="row m-0">
      
      <div class="col-md-3 col-lg-2 p-0">
        <div class="sidebar">
          <h5 class="text-secondary fw-bold mb-3 px-3 mt-2" style="font-size: 0.9rem;">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</h5>
          
          <a class="nav-link-main active" id="menu-home" onclick="showPage('home')">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
          
          <div class="mb-2">
            <a class="nav-link-sub" onclick="scrollToId('section-video')">‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</a>
            <a class="nav-link-sub" onclick="scrollToId('section-form')">‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</a>
            <a class="nav-link-sub" onclick="scrollToId('section-dashboard')">Dashboard</a>
            <a class="nav-link-sub" onclick="scrollToId('section-links')">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
          </div>

          <a class="nav-link-main" id="menu-calendar" onclick="showPage('calendar')">üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</a>
          <a class="nav-link-main" id="menu-qa" onclick="showPage('qa')">‚ùì ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A)</a>

        </div>
      </div>

      <div class="col-md-9 col-lg-10 bg-light p-0">
        <div class="main-content-wrapper">

          <div id="page-home">
            <div id="section-video" class="content-section text-center">
              <h3 class="section-header">üì∫ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
              <div class="ratio ratio-16x9 w-100 w-md-75 mx-auto shadow rounded overflow-hidden">
                <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" allowfullscreen style="border-radius: 8px;"></iframe>
              </div>
            </div>

            <div id="section-form" class="content-section">
               <h3 class="section-header">üì¢ ‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
               <p class="text-muted mb-4">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤... ‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏ö‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
               <div class="d-grid gap-2 col-md-6 mx-auto mb-3">
                 <button class="btn btn-primary btn-lg shadow-sm py-3" type="button" data-bs-toggle="collapse" data-bs-target="#formCollapse"><span class="fw-bold">üëá ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</span></button>
               </div>
               <div class="collapse" id="formCollapse">
                 <div class="card card-body bg-light border-0 shadow-sm mt-3">
                   <form id="myForm" onsubmit="submitForm(event)">
                     <div class="row">
                       <div class="col-md-6 mb-3"><label class="fw-bold mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="text-danger">*</span></label><input type="text" class="form-control" name="name" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á"></div>
                       <div class="col-md-6 mb-3"><label class="fw-bold mb-1">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label><input type="text" class="form-control" name="contact" placeholder="‡πÄ‡∏ä‡πà‡∏ô 081-xxxxxxx"></div>
                     </div>
                     <div class="mb-3">
                        <label class="fw-bold mb-1">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤ <span class="text-danger">*</span></label>
                        <select class="form-select" name="topic">
                          <option selected disabled>-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ --</option>
                          <option>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏ñ‡∏ô‡∏ô, ‡∏ô‡πâ‡∏≥, ‡πÑ‡∏ü)</option>
                          <option>‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°/‡∏°‡∏•‡∏û‡∏¥‡∏© (PM2.5, ‡∏Ç‡∏¢‡∏∞)</option>
                          <option>‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à/‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß/‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</option>
                          <option>‡∏™‡∏±‡∏á‡∏Ñ‡∏°/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</option>
                          <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                     </div>
                     <div class="mb-3"><label class="fw-bold mb-1">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î <span class="text-danger">*</span></label><textarea class="form-control" name="detail" rows="5" required placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞"></textarea></div>
                     <button type="submit" id="submitBtn" class="btn btn-success w-100 py-2 fs-5 shadow-sm">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                   </form>
                   <div id="status" class="mt-3 text-center"></div>
                 </div>
               </div>
            </div>

            <div id="section-dashboard" class="content-section text-center">
              <h3 class="section-header">üìä Dashboard ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</h3>
              <p class="text-muted">(‡∏û.‡∏®. 2566 - 2570)</p>
              <div class="p-5 border border-dashed border-2 rounded text-muted bg-light mt-3"><div class="fs-1 mb-2">üìà</div><h5>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h5><p class="small">‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p></div>
            </div>

            <div id="section-links" class="content-section">
              <h3 class="section-header">üîó ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h3>
              <div class="list-group list-group-flush border rounded overflow-hidden">
                <a href="#" class="list-group-item list-group-item-action py-3 d-flex align-items-center"><span class="fs-4 me-3">üìÑ</span> <div><div class="fw-bold">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏â‡∏ö‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</div><small class="text-muted">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå PDF</small></div></a>
                <a href="http://www.chiangmai.go.th" target="_blank" class="list-group-item list-group-item-action py-3 d-flex align-items-center"><span class="fs-4 me-3">üåê</span> <div><div class="fw-bold">‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</div><small class="text-muted">www.chiangmai.go.th</small></div></a>
              </div>
            </div>
          </div> 

          <div id="page-calendar" style="display: none;">
            
            <div class="content-section border-0 shadow-none bg-transparent p-0 mb-4">
              <h2 class="text-primary fw-bold"><i class="material-icons align-middle fs-2">calendar_month</i> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h2>
              <p class="text-muted">‡∏£‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
            </div>

            <div id="adminEventForm" class="admin-controls">
              <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom border-secondary">
                <h5 class="fw-bold text-dark m-0"><i class="material-icons align-middle">add_circle</i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</h5>
                <button type="button" class="btn btn-sm btn-danger fw-bold shadow-sm" onclick="logoutAdmin()">
                  <i class="material-icons align-middle fs-6">logout</i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                </button>
              </div>

              <form id="calForm" onsubmit="submitCalendar(event)">
                <div class="row">
                  <div class="col-md-9 mb-3"><label class="fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label><input type="text" class="form-control" name="actName" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°..."></div>
                  <div class="col-md-3 mb-3"><label class="fw-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ</label><input type="color" class="form-control form-control-color w-100" name="actColor" value="#0d6efd" title="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ"></div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3"><label class="fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</label><input type="date" class="form-control" name="actStartDate" required></div>
                  <div class="col-md-6 mb-3"><label class="fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label><input type="date" class="form-control" name="actEndDate"><small class="text-muted">*‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å</small></div>
                </div>
                <div class="mb-3"><label class="fw-bold">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label><input type="text" class="form-control" name="actLink" placeholder="http://..."></div>
                <div class="mb-3"><label class="fw-bold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label><input type="text" class="form-control" name="actDesc" placeholder="‡πÄ‡∏ß‡∏•‡∏≤ / ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà..."></div>
                <button type="submit" id="btnSaveCal" class="btn btn-warning text-dark fw-bold w-100">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</button>
              </form>
            </div>

            <div class="calendar-container shadow">
              <div class="calendar-header">
                <button class="btn-nav" onclick="changeMonth(-1)"><i class="material-icons">chevron_left</i></button>
                <h4 class="m-0 fw-bold" id="currentMonthDisplay">...</h4>
                <button class="btn-nav" onclick="changeMonth(1)"><i class="material-icons">chevron_right</i></button>
              </div>
              <div class="calendar-grid">
                <div class="day-name text-danger">‡∏≠‡∏≤.</div><div class="day-name">‡∏à.</div><div class="day-name">‡∏≠.</div><div class="day-name">‡∏û.</div><div class="day-name">‡∏û‡∏§.</div><div class="day-name">‡∏®.</div><div class="day-name text-primary">‡∏™.</div>
              </div>
              <div class="calendar-grid" id="calendarBody"></div>
            </div>
          </div>

          <div id="page-qa" style="display: none;">
            <div class="content-section">
              <h3 class="section-header">‚ùì ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢ (Q&A)</h3>
              <p class="text-muted mb-4">‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
              
              <div class="accordion accordion-flush" id="accordionQA">
                <div class="accordion-item border rounded mb-3 shadow-sm">
                  <h2 class="accordion-header"><button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#qa1">üìå ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</button></h2>
                  <div id="qa1" class="accordion-collapse collapse show"><div class="accordion-body text-muted bg-light">‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏à‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô</div></div>
                </div>
                <div class="accordion-item border rounded mb-3 shadow-sm">
                  <h2 class="accordion-header"><button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#qa2">üìÖ ‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏°‡∏µ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏µ‡πà‡∏õ‡∏µ?</button></h2>
                  <div id="qa2" class="accordion-collapse collapse"><div class="accordion-body text-muted bg-light">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏â‡∏ö‡∏±‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏õ‡∏µ (‡∏û.‡∏®. 2566 - 2570)</div></div>
                </div>
                <div class="accordion-item border rounded mb-3 shadow-sm">
                  <h2 class="accordion-header"><button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#qa3">üìû ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô?</button></h2>
                  <div id="qa3" class="accordion-collapse collapse"><div class="accordion-body text-muted bg-light">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 053-112-703 ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</div></div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <footer class="main-footer container-fluid p-0">
    <div class="row m-0">
      <div class="col-lg-4 mb-4 mb-lg-0">
        <h5>‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h5>
        <p class="mb-2 text-white-50">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        <p class="small opacity-50">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£ ‡∏ä‡∏±‡πâ‡∏ô 3 ‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏ñ‡∏ô‡∏ô‡πÇ‡∏ä‡∏ï‡∏ô‡∏≤ <br>‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà 50300</p>
        <small class="d-block mt-3 opacity-25 admin-trigger" onclick="showLoginModal()">¬© 2026 All Rights Reserved. (Admin Login)</small>
      </div>
      <div class="col-lg-4 mb-4 mb-lg-0">
        <h5>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h5>
        <ul class="list-unstyled">
          <li class="mb-3 d-flex"><span class="footer-icon">üìû</span> <span>053-112-703</span></li>
          <li class="mb-3 d-flex"><span class="footer-icon">üìß</span> <span>plancm.700@gmail.com</span></li>
          <li class="mb-3 d-flex"><span class="footer-icon">üïí</span> <span>‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå (08.30 - 16.30 ‡∏ô.)</span></li>
          <li class="mb-3 d-flex"><span class="footer-icon">üåê</span> <a href="http://www.chiangmai.go.th" class="text-decoration-none text-white-50">www.chiangmai.go.th</a></li>
        </ul>
      </div>
      <div class="col-lg-4">
        <h5>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</h5>
        <div class="map-container mb-3">
          <iframe width="100%" height="250" frameborder="0" style="border:0" src="https://maps.google.com/maps?q=‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà&t=&z=15&ie=UTF8&iwloc=&output=embed" allowfullscreen></iframe>
        </div>
        <a href="https://maps.app.goo.gl/nYjwnoS2rEB3t6DK8" target="_blank" class="btn btn-outline-light btn-sm w-100">üìç ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á via Google Maps</a>
      </div>
    </div>
  </footer>

  <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-dark text-white"><h5 class="modal-title">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body"><input type="password" id="adminPass" class="form-control text-center" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô..." onkeyup="if(event.key === 'Enter') checkPass()"><div id="loginMsg" class="text-danger text-center mt-2 small"></div></div>
        <div class="modal-footer"><button type="button" class="btn btn-primary w-100" onclick="checkPass()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button></div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="eventDetailModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg" style="border-radius: 15px; overflow: hidden;">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title fw-bold" id="modalEventTitle">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-4 bg-light">
          <div class="d-flex align-items-start mb-3">
            <i class="material-icons text-primary me-2">event</i>
            <div>
              <small class="text-muted fw-bold">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</small>
              <div id="modalEventDate" class="fw-bold text-dark"></div>
            </div>
          </div>
          <div class="d-flex align-items-start mb-4">
            <i class="material-icons text-primary me-2">info</i>
            <div>
              <small class="text-muted fw-bold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</small>
              <div id="modalEventDesc" class="text-dark" style="white-space: pre-line;"></div>
            </div>
          </div>
          
          <a id="modalEventLink" href="#" target="_blank" class="btn btn-primary w-100 py-2 rounded-pill shadow-sm">
            <i class="material-icons align-text-bottom fs-6 me-1">open_in_new</i> ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
          </a>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    // üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥
    // ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏≠‡∏≤‡∏•‡∏¥‡∏á‡∏Å‡πå Web App URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ!
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwGWDn2t6cPkNDJyuYN_RXvBfB_m7MM1gdHs4-QVKLhRWOhkDjbxeOQxoAc3ZKoJaZFEg/exec"; 
    // üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥üî¥

    let currentDate = new Date();
    let allEvents = [];
    let isAdminMode = false;

    function initSystem() { loadAllEvents(); }

    function showPage(pageId) {
      document.getElementById('page-home').style.display = 'none';
      document.getElementById('page-calendar').style.display = 'none';
      document.getElementById('page-qa').style.display = 'none';

      document.getElementById('page-' + pageId).style.display = 'block';
      
      document.querySelectorAll('.nav-link-main').forEach(el => el.classList.remove('active'));
      document.getElementById('menu-' + pageId).classList.add('active');
      
      if(pageId === 'calendar') { renderCalendar(); }
      window.scrollTo(0,0);
    }

    function scrollToId(id) {
      showPage('home');
      setTimeout(() => {
        var element = document.getElementById(id);
        if(element) { window.scrollTo({ top: element.getBoundingClientRect().top + window.pageYOffset - 100, behavior: "smooth" }); }
      }, 100);
    }

    function loadAllEvents() {
      // üü¢ ‡πÉ‡∏ä‡πâ Fetch API ‡πÅ‡∏ó‡∏ô google.script.run
      fetch(SCRIPT_URL + '?action=getEvents')
        .then(response => response.json())
        .then(data => {
          allEvents = data;
          renderCalendar();
        })
        .catch(error => console.error('Error:', error));
    }

    function renderCalendar() {
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      const thaiMonths = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
      document.getElementById('currentMonthDisplay').innerText = `${thaiMonths[month]} ${year + 543}`;

      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      let html = '';
      for (let i = 0; i < firstDay; i++) { html += `<div class="day-cell other-month"></div>`; }

      for (let day = 1; day <= daysInMonth; day++) {
        let currentDateObj = new Date(year, month, day);
        let dateKey = formatDate(currentDateObj);
        let today = new Date();
        let isToday = (day === today.getDate() && month === today.getMonth() && year === today.getFullYear()) ? 'today' : '';

        let dayEvents = allEvents.filter(ev => dateKey >= ev.startDate && dateKey <= ev.endDate);

        let eventHtml = '';
        dayEvents.forEach(ev => {
          let deleteBtn = isAdminMode ? `<span class="delete-event-btn" onclick="deleteEvent('${ev.id}', event)">‚úï</span>` : '';
          
          // üü¢ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å openEventDetail ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° (Popup ‡∏™‡∏ß‡∏¢‡πÜ)
          eventHtml += `<div class="event-badge" style="background-color: ${ev.color};" onclick="openEventDetail('${ev.id}')">${ev.title}${deleteBtn}</div>`;
        });

        html += `<div class="day-cell ${isToday}"><div class="day-number">${day}</div>${eventHtml}</div>`;
      }
      document.getElementById('calendarBody').innerHTML = html;
      
      if(isAdminMode) {
        document.querySelectorAll('.delete-event-btn').forEach(el => el.style.display = 'block');
      }
    }

    // üü¢ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Popup Modal ‡∏™‡∏ß‡∏¢‡πÜ
    function openEventDetail(id) {
      let ev = allEvents.find(e => e.id === id);
      if(!ev) return;

      document.getElementById('modalEventTitle').innerText = ev.title;
      
      let dateRange = formatDateThai(ev.startDate);
      if(ev.startDate !== ev.endDate) {
        dateRange += " - " + formatDateThai(ev.endDate);
      }
      document.getElementById('modalEventDate').innerText = dateRange;
      document.getElementById('modalEventDesc').innerText = ev.desc ? ev.desc : "- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -";
      
      let linkBtn = document.getElementById('modalEventLink');
      if(ev.link && ev.link.trim() !== "") {
        linkBtn.href = ev.link;
        linkBtn.style.display = 'block';
      } else {
        linkBtn.style.display = 'none';
      }

      // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Bootstrap Modal
      var myModal = new bootstrap.Modal(document.getElementById('eventDetailModal'));
      myModal.show();
    }

    function formatDateThai(dateStr) {
      if(!dateStr) return "";
      let d = new Date(dateStr);
      let months = ["‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢.", "‡∏Å.‡∏Ñ.", "‡∏™.‡∏Ñ.", "‡∏Å.‡∏¢.", "‡∏ï.‡∏Ñ.", "‡∏û.‡∏¢.", "‡∏ò.‡∏Ñ."];
      return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear() + 543}`;
    }

    function formatDate(date) {
      let d = new Date(date), month = '' + (d.getMonth() + 1), day = '' + d.getDate(), year = d.getFullYear();
      if (month.length < 2) month = '0' + month;
      if (day.length < 2) day = '0' + day;
      return [year, month, day].join('-');
    }

    function changeMonth(step) {
      currentDate.setMonth(currentDate.getMonth() + step);
      renderCalendar();
    }

    function deleteEvent(id, e) {
      e.stopPropagation();
      Swal.fire({
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?',
        text: "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#3085d6',
        confirmButtonText: '‡∏•‡∏ö‡πÄ‡∏•‡∏¢',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
      }).then((result) => {
        if (result.isConfirmed) {
          // üü¢ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏•‡∏ö‡∏ú‡πà‡∏≤‡∏ô API
          fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({ action: 'deleteEvent', id: id })
          })
          .then(res => res.json())
          .then(data => {
            Swal.fire('‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!', '‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            loadAllEvents();
          });
        }
      });
    }

    function logoutAdmin() {
      Swal.fire({
        title: '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?',
        icon: 'question',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#3085d6',
        confirmButtonText: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
      }).then((result) => {
        if (result.isConfirmed) {
          isAdminMode = false;
          document.getElementById('adminEventForm').style.display = 'none';
          document.getElementById('adminPass').value = '';
          document.querySelectorAll('.delete-event-btn').forEach(el => el.style.display = 'none');
          Swal.fire({ icon: 'success', title: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß', timer: 1500, showConfirmButton: false });
        }
      });
    }

    function submitCalendar(e) {
      e.preventDefault();
      var btn = document.getElementById('btnSaveCal');
      btn.disabled = true; btn.innerHTML = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
      
      var form = {
        action: 'saveCalendar', // ‡∏ö‡∏≠‡∏Å API ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£
        title: document.getElementsByName('actName')[0].value,
        startDate: document.getElementsByName('actStartDate')[0].value,
        endDate: document.getElementsByName('actEndDate')[0].value,
        link: document.getElementsByName('actLink')[0].value,
        desc: document.getElementsByName('actDesc')[0].value,
        color: document.getElementsByName('actColor')[0].value
      };

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(form)
      })
      .then(res => res.json())
      .then(data => {
        Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
        document.getElementById('calForm').reset();
        btn.disabled = false; btn.innerHTML = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°';
        loadAllEvents();
      });
    }

    var loginModal;
    function showLoginModal() { loginModal = new bootstrap.Modal(document.getElementById('loginModal')); loginModal.show(); }
    
    function checkPass() {
      var pass = document.getElementById('adminPass').value;
      // üü¢ ‡πÄ‡∏ä‡πá‡∏Ñ Login ‡∏ú‡πà‡∏≤‡∏ô API (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô)
      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'login', password: pass })
      })
      .then(res => res.json())
      .then(data => {
        if(data.status === 'SUCCESS') {
          loginModal.hide();
          isAdminMode = true;
          document.getElementById('adminEventForm').style.display = 'block';
          Swal.fire({ icon: 'success', title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', text: '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö!', timer: 1500, showConfirmButton: false });
          showPage('calendar');
        } else {
          document.getElementById('loginMsg').innerText = '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
        }
      });
    }

    function submitForm(e) {
      e.preventDefault();
      var btn = document.getElementById('submitBtn');
      var originalBtnText = btn.innerHTML;
      btn.disabled = true; btn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
      
      var data = {
        action: 'saveForm', // ‡∏ö‡∏≠‡∏Å API
        name: document.getElementsByName('name')[0].value,
        topic: document.getElementsByName('topic')[0].value,
        detail: document.getElementsByName('detail')[0].value,
        contact: document.getElementsByName('contact')[0].value
      };

      fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(data)
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('myForm').reset();
        btn.disabled = false; btn.innerHTML = originalBtnText;
        Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
      });
    }
  </script>

</body>
</html>
