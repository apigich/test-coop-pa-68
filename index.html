<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>S-MAP Chiang Mai (Smart Movement & Awareness Platform)</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    * { box-sizing: border-box; }
    body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; overflow-x: hidden; }
    
    #globalLoader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffffff; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.3s ease; }
    .loader-content { text-align: center; }
    .loader-spinner { width: 60px; height: 60px; margin: 0 auto 20px; border: 6px solid #f3f3f3; border-top: 6px solid #0d6efd; border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    .main-header { background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Doi_Suthep_02.jpg/1200px-Doi_Suthep_02.jpg') center center/cover no-repeat; color: white; position: relative; padding: 0; height: auto; min-height: 250px; display: flex; align-items: center; }
    .header-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, rgba(13, 110, 253, 0.92) 0%, rgba(0, 50, 133, 0.85) 100%); z-index: 1; }
    .header-content { position: relative; z-index: 2; width: 100%; padding: 40px; display: flex; align-items: center; justify-content: center; }
    .header-icon-box { margin-right: 30px; }
    .org-title-group { display: flex; flex-direction: column; justify-content: center; }
    .org-top-text { font-weight: 400; font-size: 1.4rem; letter-spacing: 1px; color: #ffeb3b; margin-bottom: 5px; text-transform: uppercase; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
    .org-main-text { font-weight: 700; line-height: 1.3; text-shadow: 0 4px 10px rgba(0,0,0,0.3); font-size: 2.2rem; }
    .eng-subtitle { font-weight: 300; opacity: 0.9; font-size: 1rem; margin-top: 5px; letter-spacing: 0.5px; }

    @media (max-width: 992px) { 
      .main-header { min-height: auto; }
      .header-content { flex-direction: column; text-align: center; padding: 70px 20px 40px 20px; gap: 15px; }
      .header-icon-box { margin-right: 0 !important; margin-bottom: 10px; }
      .org-top-text { font-size: 1.1rem; }
      .org-main-text { font-size: 1.5rem; line-height: 1.4; }
      .eng-subtitle { font-size: 0.85rem; margin-top: 5px; display: block; }
      .sidebar-toggle-btn { top: 20px !important; left: 20px !important; background-color: transparent !important; border: 2px solid rgba(255,255,255,0.7) !important; box-shadow: none !important; }
    }
    
    .wrapper { display: flex; width: 100%; align-items: flex-start; }
    .sidebar { min-width: 260px; max-width: 260px; background: white; border-right: 1px solid #e9ecef; transition: all 0.3s; position: sticky; top: 0; height: 100vh; overflow-y: auto; z-index: 1000; display: flex; flex-direction: column; flex-shrink: 0; }
    @media (max-width: 992px) { .sidebar { position: fixed; left: 0; top: 0; margin-left: -260px; box-shadow: 4px 0 10px rgba(0,0,0,0.1); } .sidebar.active { margin-left: 0; } .overlay { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 998; opacity: 0; transition: all 0.3s; } .overlay.active { display: block; opacity: 1; } }
    .sidebar-toggle-btn { position: absolute; z-index: 1001; color: white; border-radius: 8px; cursor: pointer; padding: 5px 10px; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; }
    .nav-link-main { padding: 15px 25px; color: #0d6efd; font-weight: 700; cursor: pointer; display: block; text-decoration: none; border-bottom: 1px solid #f8f9fa; transition: 0.2s; font-size: 1rem; }
    .nav-link-main:hover { background-color: #f1f8ff; color: #0a58ca; padding-left: 30px; }
    .nav-link-main.active { background-color: #e7f1ff; border-left: 5px solid #0d6efd; color: #0d6efd; }
    .nav-link-sub { padding: 10px 25px 10px 50px; color: #6c757d; cursor: pointer; display: block; text-decoration: none; font-size: 0.9rem; transition: 0.2s; }
    .nav-link-sub:hover { color: #0d6efd; background-color: #f8f9fa; transform: translateX(5px); }
    
    .main-content { width: 100%; padding: 20px; min-height: 100vh; background-color: #f0f2f5; flex-grow: 1; }
    .content-section { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); margin-bottom: 25px; border: 1px solid #fff; }
    .section-header { padding-bottom: 10px; margin-bottom: 20px; color: #0d6efd; font-weight: 700; font-size: 1.4rem; border-bottom: 2px solid #f0f0f0; }
    
    .carousel-item { background-color: #e9ecef; height: 500px; }
    .carousel-item img { width: auto !important; height: 100% !important; max-width: 100%; margin: 0 auto; display: block; object-fit: contain; }
    @media (max-width: 768px) { .carousel-item { height: 400px; } }

    .main-footer { background-color: #1a1d20; color: #cfd2d6; padding: 60px 40px; margin-top: auto; border-top: 5px solid #0d6efd; }
    .footer-title { color: white; font-weight: 700; margin-bottom: 20px; border-left: 4px solid #0d6efd; padding-left: 10px; }
    .admin-link-container { margin-top: 20px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); }
    .admin-trigger { color: #6c757d; font-size: 0.8rem; text-decoration: none; transition: 0.3s; cursor: pointer; display: inline-block;}
    .admin-trigger:hover { color: #adb5bd; text-decoration: underline; }

    .banner-btn { display: flex; align-items: center; justify-content: flex-start; padding: 20px; margin-bottom: 20px; border-radius: 15px; color: white; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative; overflow: hidden; border: none; width: 100%; text-align: left; background-size: cover !important; background-position: center !important; }
    .banner-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); color: white; }
    .banner-icon { flex: 0 0 100px; width: 100px; height: 100px; border-radius: 50%; font-size: 4rem; background: rgba(255,255,255,0.25); display: flex; align-items: center; justify-content: center; margin-right: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .banner-text { flex-grow: 1; position: relative; z-index: 2; overflow: hidden; }
    .banner-title { font-weight: 800; font-size: clamp(1.2rem, 2vw, 1.6rem); margin-bottom: 5px; line-height: 1.2; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    .banner-desc { font-size: 1rem; opacity: 0.95; font-weight: 400; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .status-badge { font-size: 0.85rem; padding: 4px 10px; border-radius: 20px; font-weight: bold; background: white; color: #d63031; display: inline-block; margin-right: 5px; margin-top: 5px; }
    .date-badge { font-size: 0.85rem; padding: 4px 10px; border-radius: 20px; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.5); display: inline-block; margin-top: 5px; }
    .banner-btn.closed { filter: grayscale(100%); opacity: 0.7; background: #636e72 !important; cursor: not-allowed; pointer-events: none; }
    
    /* üü¢ ‡∏õ‡πâ‡∏≤‡∏¢ NEW: ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏µ‡∏ó‡∏≠‡∏á ‡∏Ç‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡∏™‡∏µ‡πÅ‡∏î‡∏á üü¢ */
    .badge-custom-new { 
        display: inline-block;
        background-color: transparent; 
        color: #FFD700; /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ó‡∏≠‡∏á */
        -webkit-text-stroke: 0.5px #FF8C00; /* ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏°/‡∏™‡πâ‡∏° */
        text-shadow: 1px 1px 0px #FFD700, -1px -1px 0px #FFD700, 1px -1px 0px #FFD700, -1px 1px 0px #FFD700; 
        font-weight: 900; 
        font-size: 0.8rem;
        letter-spacing: 0.5px;
        padding: 3px 10px;
        border-radius: 20px;
        border: 2px solid #ff0000; /* ‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡∏µ‡πÅ‡∏î‡∏á */
        animation: pulse-red-border 1.2s infinite; /* ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡∏™‡∏µ‡πÅ‡∏î‡∏á */
    }
    @keyframes pulse-red-border { 
        0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.8); } 
        70% { box-shadow: 0 0 0 8px rgba(255, 0, 0, 0); } 
        100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); } 
    }
    
    .badge-pin { background-color: #34495e; color: white; }
    
    .bg-gradient-pink { background: linear-gradient(135deg, #ff7eb3 0%, #ff758c 100%); }
    .bg-gradient-yellow { background: linear-gradient(135deg, #fce38a 0%, #f38181 100%); color: #4a4a4a !important; }
    
    .admin-controls { display: none; background: #fff3cd; border: 1px solid #ffeeba; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
    .pagination-container { display: flex; justify-content: center; gap: 5px; margin-top: 20px; }
    .page-btn { border: 1px solid #dee2e6; background: white; color: #0d6efd; padding: 5px 12px; cursor: pointer; border-radius: 5px; }
    .page-btn.active { background: #0d6efd; color: white; border-color: #0d6efd; }
    .page-btn.disabled { opacity: 0.5; cursor: not-allowed; }
    
    .chat-container { height: 400px; overflow-y: auto; border: 1px solid #eee; background: #f8f9fa; padding: 15px; border-radius: 10px; display: flex; flex-direction: column; gap: 10px; }
    .chat-msg { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 0.95rem; line-height: 1.5; word-wrap: break-word; }
    .chat-user { align-self: flex-end; background-color: #0d6efd; color: white; border-bottom-right-radius: 2px; }
    .chat-ai { align-self: flex-start; background-color: white; color: #333; border: 1px solid #e0e0e0; border-bottom-left-radius: 2px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    .chat-ai strong { color: #0d6efd; }
    .typing-indicator span { display: inline-block; width: 6px; height: 6px; background-color: #888; border-radius: 50%; animation: blink 1.4s infinite both; margin: 0 2px; }
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; } .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes blink { 0% { opacity: 0.2; } 20% { opacity: 1; } 100% { opacity: 0.2; } }

    .video-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; transition: transform 0.2s; border: 1px solid #eee; }
    .video-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.15); }
    .video-title-bar { padding: 12px 15px; background: #f8f9fa; border-bottom: 1px solid #eee; font-weight: bold; color: #333; font-size: 0.95rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
    .video-title-text { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; flex-grow: 1; padding-right: 10px; }
    .video-title-bar:hover { background-color: #e9ecef; }
    
    .star-rating i { font-size: 2.5rem; color: #ccc; cursor: pointer; transition: color 0.2s; }
    .star-rating i.hover { color: #f1c40f; opacity: 0.5; }
    .star-rating i.active { color: #f39c12; }
    
    .hearing-banner-img { width: 100%; max-height: 250px; object-fit: cover; border-radius: 8px; margin-bottom: 15px; }

    .dash-card { border-left: 5px solid; transition: transform 0.2s; }
    .dash-card:hover { transform: translateY(-3px); }
    .dash-icon { width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white; }
    .dash-num { font-size: 2rem; font-weight: bold; line-height: 1.2; }

    .floating-menu-btn { position: fixed; bottom: 30px; right: 20px; width: 55px; height: 55px; background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%); color: white; border-radius: 50%; border: none; box-shadow: 0 4px 15px rgba(13, 110, 253, 0.4); display: flex; align-items: center; justify-content: center; z-index: 997; cursor: pointer; transition: all 0.3s ease; }
    .floating-menu-btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 6px 20px rgba(13, 110, 253, 0.6); }
    .floating-menu-btn i { font-size: 28px; }
  </style>
</head>
<body onload="initSystem()">

  <div id="globalLoader">
    <div class="loader-content">
      <div class="loader-spinner"></div>
      <h5 class="text-primary fw-bold">‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° S-MAP Chiang Mai</h5>
      <div class="text-muted small">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</div>
    </div>
  </div>

  <script>
    // ** ‡πÉ‡∏™‡πà Web App URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏ù‡∏±‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö) **
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwGWDn2t6cPkNDJyuYN_RXvBfB_m7MM1gdHs4-QVKLhRWOhkDjbxeOQxoAc3ZKoJaZFEg/exec"; 
  </script>

  <header class="main-header container-fluid">
    <div class="header-overlay"></div>
    <div class="header-content">
      <button class="sidebar-toggle-btn d-lg-none me-3" onclick="toggleSidebar()"><i class="material-icons">menu</i></button>
      <div class="header-icon-box d-none d-lg-block"><i class="material-icons" style="font-size: 5.5rem;">account_balance</i></div> 
      <div class="header-icon-box d-block d-lg-none"><i class="material-icons" style="font-size: 4.5rem;">account_balance</i></div> 
      <div class="org-title-group">
        <div class="org-top-text">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</div>
        <h1 class="m-0 org-main-text">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h1>
        <div class="eng-subtitle">Strategy and Information for Provincial Development</div>
      </div>
    </div>
  </header>

  <button class="floating-menu-btn d-lg-none" onclick="toggleSidebar()"><i class="material-icons">menu</i></button>

  <div class="wrapper">
    <div class="overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <nav class="sidebar" id="sidebar">
      <div class="flex-grow-1 pt-4">
        <h6 class="px-3 text-secondary fw-bold mt-2 mb-3" style="font-size: 0.85rem; letter-spacing: 1px;">MENU</h6>
        <a class="nav-link-main active" id="menu-home" onclick="showPage('home')">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <div id="sub-home" class="mb-2">
          <a class="nav-link-sub" onclick="scrollToId('section-video')">‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-feedback')">‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-dash')">üìçDashboard</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-pr')">‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-facebook')">‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</a>
        </div>
        <a class="nav-link-main" id="menu-videos" onclick="showPage('videos')">‚ñ∂Ô∏è ‡∏Ñ‡∏•‡∏±‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</a>
        <a class="nav-link-main" id="menu-docs" onclick="showPage('docs')">üìÇ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
        <a class="nav-link-main" id="menu-calendar" onclick="showPage('calendar')">üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</a>
        <a class="nav-link-main" id="menu-qa" onclick="showPage('qa')">‚ùì ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A)</a>

        <div id="adminMenuSection" style="display:none;">
            <hr class="mx-3 text-secondary">
            <h6 class="px-3 text-danger fw-bold mt-2 mb-2" style="font-size: 0.75rem;">ADMINISTRATOR</h6>
            <a class="nav-link-main text-danger bg-danger bg-opacity-10 border-start border-3 border-danger" onclick="showPage('admin-dash')">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin)</a>
        </div>
      </div>
      
      <div id="sidebarLogoutArea" class="px-3 mb-4 mt-auto" style="display:none;"></div>
    </nav>

    <div class="main-content">
      
      <div id="page-home">
        
        <div id="section-video" class="content-section text-center">
          <h3 class="section-header" id="disp_video_title">üì∫ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
          <div class="ratio ratio-16x9 w-100 w-md-75 mx-auto shadow rounded overflow-hidden" style="max-width: 800px;"><iframe id="main_video_frame" src="" allowfullscreen></iframe></div>
          <div class="mt-4"><button onclick="showPage('videos')" class="btn btn-outline-primary fw-bold rounded-pill px-4">‚ñ∂Ô∏è ‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (Click Here)</button></div>
        </div>

        <div id="adminHomePanel" class="content-section bg-warning-subtle border-warning" style="display:none;">
          <div class="d-flex justify-content-between align-items-center mb-3 border-bottom border-warning pb-2">
             <h5 class="fw-bold text-dark m-0"><i class="material-icons align-middle text-success">verified_user</i> ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h5>
             <button class="btn btn-sm btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle fs-6">logout</i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
          </div>
          
          <div class="mt-3 bg-white p-3 rounded shadow-sm border-start border-4 border-danger">
             <h6 class="fw-bold text-danger mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ (‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π)</h6>
             <div class="row">
                 <div class="col-md-6 mb-2"><label class="small text-muted">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠:</label><input type="text" id="admin_title_1" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small text-muted">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (Subtitle):</label><input type="text" id="admin_subtitle_1" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small text-muted">‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label><input type="text" id="admin_date_1" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2 d-flex align-items-end">
                     <div class="form-check form-switch bg-light p-2 rounded w-100"><label class="form-check-label fw-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö</label><input class="form-check-input fs-5 float-end" type="checkbox" id="swForm1"></div>
                 </div>
             </div>
             <button class="btn btn-sm btn-outline-danger w-100 mt-2" onclick="saveFormConfig(1)">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏° 1</button>
          </div>

          <div class="mt-3 bg-white p-3 rounded shadow-sm border-start border-4 border-warning">
             <h6 class="fw-bold text-warning text-dark mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏° (‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á)</h6>
             <div class="mb-3 p-2 bg-warning bg-opacity-10 border border-warning rounded">
                 <label class="small text-dark fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô (‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°):</label>
                 <input type="text" id="h_admin_plan_name" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏û.‡∏®. 2566 - 2570">
             </div>
             <div class="row bg-light p-2 rounded mb-3">
                 <div class="col-md-6 mb-2"><label class="small text-muted fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ö‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å:</label><input type="text" id="h_admin_title" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small text-muted fw-bold">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (Subtitle):</label><input type="text" id="h_admin_desc" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small text-muted fw-bold">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:</label><input type="text" id="h_admin_date" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2 d-flex gap-2">
                     <div class="form-check form-switch w-50 p-2 border rounded bg-white"><label class="form-check-label small">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö</label><input class="form-check-input float-end" type="checkbox" id="swHearingStatus"></div>
                     <div class="form-check form-switch w-50 p-2 border rounded bg-white"><label class="form-check-label small">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ó‡πâ‡∏≤‡∏¢‡∏ü‡∏≠‡∏£‡πå‡∏°</label><input class="form-check-input float-end" type="checkbox" id="swHearingRating"></div>
                 </div>
             </div>
             <div class="mb-3 p-2 border rounded border-primary border-opacity-25 bg-white">
                 <label class="fw-bold text-primary small mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (‡πÅ‡∏™‡∏î‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2)</label>
                 <div class="input-group input-group-sm mb-2"><span class="input-group-text bg-light">‡∏†‡∏≤‡∏û‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</span><input type="text" class="form-control" id="h_admin_img" placeholder="URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"></div>
                 <div class="mb-2"><input type="text" class="form-control form-control-sm" id="h_admin_info_title" placeholder="‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• / ‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)"></div>
                 <div class="mb-2"><textarea class="form-control form-control-sm" id="h_admin_info_desc" rows="3" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô..."></textarea></div>
                 <div class="input-group input-group-sm mb-1"><span class="input-group-text bg-light">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡πà‡∏≠</span><input type="text" class="form-control" id="h_admin_sum" placeholder="URL ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ"></div>
                 <div class="input-group input-group-sm mb-1"><span class="input-group-text bg-light">‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ú‡∏ô‡πÄ‡∏ï‡πá‡∏°</span><input type="text" class="form-control" id="h_admin_full" placeholder="URL ‡∏£‡πà‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå"></div>
             </div>
             <div class="mb-3 p-2 border rounded border-success border-opacity-25 bg-white">
                 <label class="fw-bold text-success small mb-2">‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ 100%)</label>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q1" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1"></div>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q2" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2"></div>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q3" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3"></div>
                 <div class="ps-3 mb-1"><input type="text" class="form-control form-control-sm text-muted" id="h_admin_s3_1" placeholder="‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏¢‡πà‡∏≠‡∏¢ 1 (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à)"></div>
                 <div class="ps-3 mb-1"><input type="text" class="form-control form-control-sm text-muted" id="h_admin_s3_2" placeholder="‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏¢‡πà‡∏≠‡∏¢ 2 (‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏±‡∏á‡∏Ñ‡∏°)"></div>
                 <div class="ps-3 mb-2"><input type="text" class="form-control form-control-sm text-muted" id="h_admin_s3_3" placeholder="‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏¢‡πà‡∏≠‡∏¢ 3 (‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°)"></div>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q4" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4"></div>
             </div>
             <button class="btn btn-sm btn-warning w-100 fw-bold" onclick="saveHearingConfig()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
          </div>

          <div class="mt-3 bg-white p-3 rounded shadow-sm border-start border-4 border-info">
             <h6 class="fw-bold text-info mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏´‡∏•‡∏±‡∏Å & Dashboard)</h6>
             <div class="mb-2"><label class="small text-muted">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏´‡∏•‡∏±‡∏Å:</label><input type="text" id="admin_video_title" class="form-control form-control-sm"></div>
             <div class="mb-2"><label class="small text-muted">‡∏•‡∏¥‡∏á‡∏Å‡πå YouTube (Video URL):</label><input type="text" id="admin_video_url" class="form-control form-control-sm"></div>
             <div class="mb-2"><label class="small text-muted">‡∏•‡∏¥‡∏á‡∏Å‡πå Dashboard (Dashboard URL):</label><input type="text" id="admin_dash_url" class="form-control form-control-sm"></div>
             <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="saveGeneralConfig()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
          </div>
        </div>

        <div id="sec-feedback" class="content-section text-center" style="background: #fff;">
          <h3 class="fw-bold mb-5 text-dark" style="letter-spacing: 1px;">üì¢ ‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
          <div class="row justify-content-center">
            
            <div class="col-lg-9 mb-4 position-relative">
              <div id="banner1" class="banner-btn bg-gradient-pink closed" onclick="handleBannerClick(1)" role="button">
                <div class="banner-icon"><i class="material-icons">assignment</i></div>
                <div class="banner-text">
                   <div class="banner-title" id="disp_title_1">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                   <div class="banner-desc" id="disp_desc_1">...</div>
                   <div class="mt-2" id="info1"><span id="statusBadge1" class="status-badge" style="display:none;">‚õî ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á</span><span class="date-badge" id="disp_date_1">...</span></div>
                </div>
              </div>
            </div>

            <div class="col-lg-9 mb-3 position-relative">
              <div id="banner2" class="banner-btn bg-gradient-yellow closed" onclick="handleBannerClick(2)" role="button">
                <div class="banner-icon"><i class="material-icons">groups</i></div>
                <div class="banner-text">
                   <div class="banner-title" id="disp_title_2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                   <div class="banner-desc" id="disp_desc_2">...</div>
                   <div class="mt-2" id="info2"><span id="statusBadge2" class="status-badge" style="display:none;">‚õî ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô</span><span class="date-badge" id="disp_date_2">...</span></div>
                </div>
              </div>
            </div>
            
          </div>
        </div>

        <div id="sec-dash" class="content-section text-center">
          <h4 class="text-primary mb-4 fw-bold">üìä Dashboard ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
          <div id="dashboard_container" class="ratio ratio-16x9 w-100 border rounded shadow-sm bg-white overflow-hidden">
             <div id="dash_placeholder" class="d-flex flex-column align-items-center justify-content-center h-100 bg-light text-muted"><i class="material-icons" style="font-size: 4rem;">bar_chart</i><h5 class="mt-3">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Dashboard</h5><p>‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p></div>
             <iframe id="main_dash_frame" src="" allowfullscreen style="display:none;"></iframe>
          </div>
        </div>

        <div id="sec-pr" class="content-section">
          <h4 class="text-primary mb-4 fw-bold"><i class="material-icons align-middle">campaign</i> ‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (Info-Graphics)</h4>
          <div id="prCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="0" class="active"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="1"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="2"></button>
            </div>
            <div class="carousel-inner">
              <div class="carousel-item active" data-bs-interval="4000"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Doi_Suthep_02.jpg/1280px-Doi_Suthep_02.jpg"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://thailandtourismdirectory.go.th/assets/upload/2018/01/22/2018012216262947119e830f576313.jpg"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Chiang_Mai_Night_Bazaar.jpg/1280px-Chiang_Mai_Night_Bazaar.jpg"></div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#prCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon bg-dark rounded-circle p-2"></span></button>
            <button class="carousel-control-next" type="button" data-bs-target="#prCarousel" data-bs-slide="next"><span class="carousel-control-next-icon bg-dark rounded-circle p-2"></span></button>
          </div>
        </div>

        <div id="sec-facebook" class="content-section">
          <h4 class="text-primary mb-4 fw-bold"><i class="material-icons align-middle">newspaper</i> ‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (Facebook)</h4>
          <div class="bg-white rounded shadow-sm border p-3 text-center">
            <iframe src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2FChiangmaioffice&tabs=timeline&width=500&height=350&small_header=true&adapt_container_width=true&hide_cover=false&show_facepile=false" width="100%" height="350" style="border:none; overflow:hidden; max-width: 500px;" scrolling="no" frameborder="0" allowfullscreen="true" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
            <div class="text-center mt-3"><a href="https://www.facebook.com/Chiangmaioffice" target="_blank" class="btn btn-outline-primary btn-sm rounded-pill">‡∏î‡∏π‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ö‡∏ô Facebook <i class="material-icons align-middle fs-6">open_in_new</i></a></div>
          </div>
        </div>

      </div>

      <div id="page-docs" style="display:none;">
        <div class="content-section">
          <div class="d-flex justify-content-between align-items-center mb-3">
             <h3 class="section-header m-0 border-0 pb-0">üìÇ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h3>
             <div id="adminDocBtnGroup" style="display:none; gap: 8px;">
                 <button class="btn btn-primary fw-bold" onclick="openDocModal()"><i class="material-icons align-middle">add</i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
                 <button class="btn btn-danger fw-bold" onclick="logoutSystem()" title="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö"><i class="material-icons align-middle">logout</i></button>
             </div>
          </div>
          <hr class="text-secondary mt-0 mb-3">
          
          <div class="row g-2 mb-3 align-items-center p-3 bg-light rounded border">
             <div class="col-md-4">
                 <label class="small text-muted fw-bold mb-1">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                 <input type="search" id="searchDoc" class="form-control" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£..." oninput="filterDocs()">
             </div>
             <div class="col-md-3">
                 <label class="small text-muted fw-bold mb-1">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                 <select id="filterCat" class="form-select" onchange="filterDocs()"><option value="All">‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option><option value="General">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option><option value="Plan">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤</option><option value="Report">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•</option><option value="Announcement">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</option></select>
             </div>
             <div class="col-md-3">
                 <label class="small text-muted fw-bold mb-1">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
                 <select id="filterYear" class="form-select" onchange="filterDocs()"><option value="All">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option></select>
             </div>
             <div class="col-md-2 mt-auto">
                 <button class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-center" onclick="clearSearch()"><i class="material-icons me-1" style="font-size: 18px;">refresh</i> ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
             </div>
          </div>
          <div class="text-muted small mb-3 text-start px-2"><b>* ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</b> ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á AI ‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ö‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö Chat Bot ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£ ‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö AI ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥</div>
          <div id="docListContainer" class="list-group list-group-flush border rounded shadow-sm"></div>
          <div id="pagination" class="pagination-container"></div>
        </div>
      </div>

      <div id="page-admin-dash" style="display:none;">
          <div class="content-section">
             <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                 <h3 class="m-0 fw-bold text-dark"><i class="material-icons align-middle text-danger">analytics</i> ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin Dashboard)</h3>
                 <div>
                    <a id="btnOpenSheet" href="#" target="_blank" class="btn btn-success fw-bold me-2"><i class="material-icons align-middle">table_view</i> ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets</a>
                    <button class="btn btn-outline-secondary" onclick="loadDashboard()"><i class="material-icons align-middle">refresh</i> ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î</button>
                 </div>
             </div>

             <div class="mb-4">
                 <h5 class="fw-bold text-danger mb-3">1. ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ (‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π)</h5>
                 <div class="row g-3">
                     <div class="col-md-4">
                         <div class="card shadow-sm h-100 dash-card" style="border-left-color: #e91e63;">
                             <div class="card-body d-flex align-items-center">
                                 <div class="dash-icon bg-danger me-3"><i class="material-icons">assignment_late</i></div>
                                 <div>
                                     <div class="text-muted small fw-bold">‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                                     <div class="dash-num text-danger" id="stat_issues_total">0</div>
                                     <small class="text-secondary">‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</small>
                                 </div>
                             </div>
                         </div>
                     </div>
                     <div class="col-md-8">
                         <div class="card shadow-sm h-100"><div class="card-body"><h6 class="card-title fw-bold text-muted small">‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h6><canvas id="chartIssues" style="max-height: 200px;"></canvas></div></div>
                     </div>
                 </div>
             </div>
             <hr class="my-5 border-secondary border-2 opacity-25">
             <div>
                 <h5 class="fw-bold text-warning text-dark mb-3">2. ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏° (‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á)</h5>
                 <div class="row g-3">
                     <div class="col-md-3">
                         <div class="card shadow-sm h-100 dash-card" style="border-left-color: #f1c40f;">
                             <div class="card-body d-flex align-items-center">
                                 <div class="dash-icon bg-warning text-dark me-3"><i class="material-icons">groups</i></div>
                                 <div>
                                     <div class="text-muted small fw-bold">‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                                     <div class="dash-num text-dark" id="stat_hearing_total">0</div>
                                     <small class="text-secondary">‡∏Ñ‡∏ô</small>
                                 </div>
                             </div>
                         </div>
                     </div>
                     <div class="col-md-9">
                         <div class="row g-3">
                             <div class="col-md-6"><div class="card shadow-sm h-100 border-0" style="border-top: 3px solid #f1c40f !important;"><div class="card-body p-2"><h6 class="text-center small fw-bold mt-2 text-muted">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô</h6><canvas id="chartSector" style="max-height: 180px;"></canvas></div></div></div>
                             <div class="col-md-6"><div class="card shadow-sm h-100 border-0" style="border-top: 3px solid #f1c40f !important;"><div class="card-body p-2"><h6 class="text-center small fw-bold mt-2 text-muted">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå/‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</h6><canvas id="chartVision" style="max-height: 180px;"></canvas></div></div></div>
                         </div>
                     </div>
                 </div>
                 <div class="row g-3 mt-1">
                     <div class="col-md-12"><h6 class="fw-bold text-secondary mb-2 border-bottom pb-2"><i class="material-icons align-middle fs-6">bar_chart</i> ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ (Strategic Issues)</h6></div>
                     <div class="col-md-4"><div class="card shadow-sm h-100 border-0" style="border-top: 3px solid #f1c40f !important;"><div class="card-body p-2"><h6 class="text-center small fw-bold mt-2 text-dark">‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à</h6><canvas id="chartEcon" style="max-height: 180px;"></canvas></div></div></div>
                     <div class="col-md-4"><div class="card shadow-sm h-100 border-0" style="border-top: 3px solid #f1c40f !important;"><div class="card-body p-2"><h6 class="text-center small fw-bold mt-2 text-dark">‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</h6><canvas id="chartSocial" style="max-height: 180px;"></canvas></div></div></div>
                     <div class="col-md-4"><div class="card shadow-sm h-100 border-0" style="border-top: 3px solid #f1c40f !important;"><div class="card-body p-2"><h6 class="text-center small fw-bold mt-2 text-dark">‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</h6><canvas id="chartEnv" style="max-height: 180px;"></canvas></div></div></div>
                 </div>
                 <div class="row g-3 mt-1 mb-5">
                     <div class="col-md-12"><div class="card shadow-sm h-100 border-start border-4 dash-card" style="border-left-color: #f1c40f !important;"><div class="card-body p-3"><h6 class="small fw-bold text-dark mb-3">‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</h6><canvas id="chartPriority" style="max-height: 200px;"></canvas></div></div></div>
                 </div>
             </div>
          </div>
      </div>

      <div id="page-videos" style="display:none;">
        <div class="content-section">
          <div class="d-flex justify-content-between align-items-center mb-3">
             <h3 class="section-header m-0 border-0 pb-0">‚ñ∂Ô∏è ‡∏Ñ‡∏•‡∏±‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
             <div id="adminVideoBtnGroup" style="display:none; gap: 8px;">
                 <button class="btn btn-primary fw-bold" onclick="openVideoModal()"><i class="material-icons align-middle">add</i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</button>
                 <button class="btn btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle">logout</i></button>
             </div>
          </div>
          <hr class="text-secondary mt-0 mb-4">
          <div id="videoListContainer" class="row g-4"><div class="text-center text-muted py-5 w-100">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠...</div></div>
        </div>
      </div>
      
      <div id="page-calendar" style="display:none;">
        <div class="content-section border-0 bg-transparent p-0 mb-4 shadow-none">
          <h2 class="text-primary fw-bold"><i class="material-icons align-middle fs-2">calendar_month</i> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h2>
          <p class="text-muted">‡∏£‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        </div>
        <div class="alert alert-info shadow-sm" role="alert"><i class="material-icons align-middle me-2">info</i> ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</div>
        <div class="content-section text-center py-5 shadow-sm border">
           <i class="material-icons text-primary mb-3" style="font-size: 5rem;">event_available</i>
           <h3 class="fw-bold text-dark">‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</h3>
           <p class="text-muted mb-4">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Server ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á</p>
           <a href="http://164.115.44.24/cmbase/public/calendar" target="_blank" class="btn btn-primary btn-lg rounded-pill px-5 py-3 shadow"><i class="material-icons align-middle me-2">open_in_new</i> ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</a>
        </div>
      </div>

      <div id="page-qa" style="display:none;">
        <div class="content-section">
          <div class="d-flex justify-content-between align-items-center mb-3">
             <h3 class="section-header m-0 border-0 pb-0">‚ùì ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A)</h3>
             <div id="adminQABtnGroup" style="display:none; gap: 8px;">
                 <button class="btn btn-primary fw-bold" onclick="openQAModal()"><i class="material-icons align-middle">add</i> ‡πÄ‡∏û‡∏¥‡πà‡∏° Q&A</button>
                 <button class="btn btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle">logout</i></button>
             </div>
          </div>
          <hr class="text-secondary mt-0 mb-4">
          <div class="accordion accordion-flush border rounded shadow-sm" id="accQA"></div>
        </div>
      </div>

    </div> 
  </div> 

  <footer class="main-footer container-fluid p-0">
    <div class="row m-0">
      <div class="col-lg-4 mb-4 mb-lg-0">
        <h5 class="footer-title">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h5>
        <p class="mb-2 text-white-50">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        <p class="small opacity-50">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£ ‡∏ä‡∏±‡πâ‡∏ô 3 ‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏ñ‡∏ô‡∏ô‡πÇ‡∏ä‡∏ï‡∏ô‡∏≤ <br>‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà 50300</p>
        <div id="footerCopyright">¬© 2026 All Rights Reserved.</div>
        <div class="admin-link-container"><a href="javascript:void(0);" onclick="loginToggle()" class="admin-trigger"><i class="material-icons align-middle fs-6 me-1">lock</i>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</a></div>
      </div>
      <div class="col-lg-4 mb-4 mb-lg-0">
        <h5 class="footer-title">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h5>
        <ul class="list-unstyled">
          <li class="mb-3 d-flex"><span class="me-2">üìû</span> <span>053-112-703</span></li>
          <li class="mb-3 d-flex"><span class="me-2">üìß</span> <span>plancm.700@gmail.com</span></li>
          <li class="mb-3 d-flex"><span class="me-2">üïí</span> <span>‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå (08.30 - 16.30 ‡∏ô.)</span></li>
          <li class="mb-3 d-flex"><span class="me-2">üåê</span> <a href="http://www.chiangmai.go.th" class="text-decoration-none text-white-50">www.chiangmai.go.th</a></li>
        </ul>
      </div>
      <div class="col-lg-4">
        <h5 class="footer-title">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</h5>
        <div class="map-container mb-3" style="height: 200px; background: #333;"><iframe src="https://maps.google.com/maps?q=%E0%B8%A8%E0%B8%B2%E0%B8%A5%E0%B8%B2%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94%E0%B9%80%E0%B8%8A%E0%B8%B5%E0%B8%A2%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88&t=&z=15&ie=UTF8&iwloc=&output=embed" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe></div>
        <a href="https://www.google.com/maps/search/?api=1&query=‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà" target="_blank" class="btn btn-outline-light btn-sm w-100"><i class="material-icons align-middle fs-6">near_me</i> ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á via Google Maps</a>
      </div>
    </div>
  </footer>

  <div class="modal fade" id="chatModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title fw-bold"><i class="material-icons align-text-bottom me-2">smart_toy</i> ‡∏ñ‡∏≤‡∏° AI ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-0">
          <div id="chatHistory" class="chat-container"></div>
          <div class="p-3 border-top bg-light">
             <div class="input-group">
                <input type="text" id="chatInput" class="form-control" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°..." onkeypress="if(event.key==='Enter') sendChat()">
                <button class="btn btn-primary" onclick="sendChat()"><i class="material-icons">send</i></button>
             </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="formModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title fw-bold" id="formTitle">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-4">
          <form onsubmit="submitForm(event)">
            <input type="hidden" id="f_topic_type">
            <div class="mb-3"><label class="fw-bold form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="text-danger">*</span></label><input class="form-control" id="f_name" required></div>
            <div class="mb-3"><label class="fw-bold form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label><input class="form-control" id="f_contact"></div>
            <div class="mb-3" id="topicSelectDiv">
               <label class="fw-bold form-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà <span class="text-danger">*</span></label>
               <select class="form-select" id="f_topic_select" required><option value="" selected disabled>-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</option><option>‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°/‡∏°‡∏•‡∏û‡∏¥‡∏©</option><option>‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à/‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</option><option>‡∏™‡∏±‡∏á‡∏Ñ‡∏°/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</option><option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option></select>
            </div>
            <div class="mb-3"><label class="fw-bold form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î <span class="text-danger">*</span></label><textarea class="form-control" id="f_detail" rows="5" required></textarea></div>
            <div class="d-grid"><button class="btn btn-success py-2 fw-bold shadow-sm">üöÄ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button></div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="hearingModal" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header bg-warning text-dark">
          <h5 class="modal-title fw-bold" id="disp_h_title">‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body bg-light">
          <div class="text-center mb-2"><img id="disp_h_img" class="hearing-banner-img shadow-sm" src="" style="display:none;"></div>
          <div id="hearingClosedMsg" class="alert alert-danger text-center shadow-sm" style="display:none;"><i class="material-icons fs-1 mb-2">lock</i><h5 class="fw-bold">‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß</h5></div>

          <form id="hearingFormContainer" onsubmit="submitHearing(event)" class="bg-white p-3 p-md-4 border rounded shadow-sm">
             <h4 class="fw-bold text-center text-primary mb-4" id="disp_h_plan_name">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</h4>
             
             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3" id="disp_h_q1">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h5>
             <div class="row g-3 mb-4">
                <div class="col-md-6"><label class="form-label fw-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="text-danger">*</span></label><input type="text" class="form-control" id="h_name" required></div>
                <div class="col-md-6"><label class="form-label fw-bold">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢ <span class="text-danger">*</span></label><input type="text" class="form-control" id="h_district" required></div>
                <div class="col-md-12">
                   <label class="form-label fw-bold">‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏î <span class="text-danger">*</span></label>
                   <select class="form-select" id="h_sector" required><option value="" selected disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô --</option><option value="‡∏†‡∏≤‡∏Ñ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô">‡∏†‡∏≤‡∏Ñ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô / ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏á‡∏Ñ‡∏°</option><option value="‡∏†‡∏≤‡∏Ñ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô">‡∏†‡∏≤‡∏Ñ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à / ‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</option><option value="‡∏†‡∏≤‡∏Ñ‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£">‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ / ‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à / ‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô</option><option value="‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤">‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ / ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</option></select>
                </div>
             </div>

             <div class="bg-light border rounded p-4 mb-4 mt-2 shadow-sm border-primary border-opacity-25">
                 <h5 class="fw-bold text-dark mb-2" id="disp_h_info_title">‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</h5>
                 <p class="text-muted mb-4" id="disp_h_info_desc" style="white-space: pre-line;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á...</p>
                 <div class="d-flex justify-content-start gap-3 flex-wrap mb-4">
                     <a id="disp_h_sum" href="#" target="_blank" class="btn btn-outline-primary fw-bold rounded-pill px-4" style="display:none;"><i class="material-icons align-middle fs-6 me-1">description</i> ‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡πà‡∏≠</a>
                     <a id="disp_h_full" href="#" target="_blank" class="btn btn-primary fw-bold rounded-pill px-4" style="display:none;"><i class="material-icons align-middle fs-6 me-1">menu_book</i> ‡∏£‡πà‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°</a>
                 </div>
                 <div class="form-check border-top pt-3">
                     <input class="form-check-input" type="checkbox" id="h_info_consent" required>
                     <label class="form-check-label fw-bold text-danger" for="h_info_consent">‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡πà‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Ø ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß <span class="text-danger">*</span></label>
                 </div>
             </div>

             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3 mt-4" id="disp_h_q2">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå</h5>
             <div class="mb-4 ps-2">
                <div class="form-check mb-2"><input class="form-check-input" type="radio" name="h_vision" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢" required><label class="form-check-label">‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</label></div>
                <div class="form-check mb-2"><input class="form-check-input" type="radio" name="h_vision" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"><label class="form-check-label">‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label></div>
                <div class="form-check"><input class="form-check-input" type="radio" name="h_vision" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"><label class="form-check-label">‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</label></div>
                <textarea class="form-control mt-3" id="h_vision_fb" rows="2" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)..."></textarea>
             </div>

             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3" id="disp_h_q3">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</h5>
             <div class="table-responsive mb-2">
                <table class="table table-bordered table-striped align-middle text-center small">
                   <thead class="table-light"><tr><th class="text-start">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤</th><th>‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å</th><th>‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</th><th>‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à</th><th>‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</th></tr></thead>
                   <tbody>
                      <tr><td class="text-start fw-bold" id="disp_h_s3_1">1. ‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à</td><td><input class="form-check-input" type="radio" name="h_econ" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å" required></td><td><input class="form-check-input" type="radio" name="h_econ" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td><td><input class="form-check-input" type="radio" name="h_econ" value="‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à"></td><td><input class="form-check-input" type="radio" name="h_econ" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td></tr>
                      <tr><td class="text-start fw-bold" id="disp_h_s3_2">2. ‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td><td><input class="form-check-input" type="radio" name="h_soc" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å" required></td><td><input class="form-check-input" type="radio" name="h_soc" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td><td><input class="form-check-input" type="radio" name="h_soc" value="‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à"></td><td><input class="form-check-input" type="radio" name="h_soc" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td></tr>
                      <tr><td class="text-start fw-bold" id="disp_h_s3_3">3. ‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</td><td><input class="form-check-input" type="radio" name="h_env" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å" required></td><td><input class="form-check-input" type="radio" name="h_env" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td><td><input class="form-check-input" type="radio" name="h_env" value="‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à"></td><td><input class="form-check-input" type="radio" name="h_env" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td></tr>
                   </tbody>
                </table>
             </div>
             <textarea class="form-control mb-4" id="h_strategy_fb" rows="2" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)..."></textarea>

             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3" id="disp_h_q4">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</h5>
             <div class="mb-3">
                <select class="form-select" id="h_priority" required><option value="" selected disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î --</option><option value="‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ">‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</option><option value="‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á</option><option value="‡∏î‡πâ‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥">‡∏î‡πâ‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</option></select>
             </div>
             <div class="mb-3"><textarea class="form-control" id="h_feedback" rows="3" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)..."></textarea></div>

             <div class="alert alert-secondary mt-4 mb-4 small">
                <div class="form-check">
                   <input class="form-check-input" type="checkbox" id="h_pdpa" required>
                   <label class="form-check-label text-dark" for="h_pdpa">‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡πà‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Ø ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ï‡πà‡∏≠‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</label>
                </div>
             </div>
             <div class="d-grid"><button type="submit" class="btn btn-warning btn-lg fw-bold shadow-sm text-dark" id="btnSubmitHearing">‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</button></div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="ratingModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content text-center">
        <div class="modal-header bg-warning text-dark border-0">
          <h5 class="modal-title fw-bold mx-auto">‚≠ê ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h5>
        </div>
        <div class="modal-body p-4">
          <h5 class="mb-4 text-success fw-bold">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Ç‡∏≠‡∏ö‡∏û‡∏£‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏¥‡πà‡∏á!</h5>
          <p class="text-muted">‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö S-MAP</p>
          <div class="star-rating mb-4 d-flex justify-content-center gap-2" id="starContainer">
             <i class="material-icons" data-val="1" onclick="setStar(1)" onmouseover="hoverStar(1)" onmouseout="resetStar()">star</i>
             <i class="material-icons" data-val="2" onclick="setStar(2)" onmouseover="hoverStar(2)" onmouseout="resetStar()">star</i>
             <i class="material-icons" data-val="3" onclick="setStar(3)" onmouseover="hoverStar(3)" onmouseout="resetStar()">star</i>
             <i class="material-icons" data-val="4" onclick="setStar(4)" onmouseover="hoverStar(4)" onmouseout="resetStar()">star</i>
             <i class="material-icons" data-val="5" onclick="setStar(5)" onmouseover="hoverStar(5)" onmouseout="resetStar()">star</i>
          </div>
          <input type="hidden" id="sys_rating_val" value="0">
          <div class="mb-3 text-start"><textarea class="form-control" id="sys_feedback" rows="2" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ß‡πá‡∏ö (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)..."></textarea></div>
          <button type="button" class="btn btn-primary w-100 fw-bold" onclick="submitRating()">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="adminDocModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-dark text-white">
            <h5 class="modal-title fw-bold" id="docModalTitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body bg-light">
          <form id="adminDocForm" onsubmit="submitDocument(event)">
             <input type="hidden" id="doc_id">
             
             <div class="row g-2 mb-2">
                 <div class="col-md-9">
                     <label class="small fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ <span class="text-danger">*</span></label>
                     <input type="text" class="form-control" id="doc_title" required>
                 </div>
                 <div class="col-md-3">
                     <label class="small fw-bold">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
                     <input type="text" class="form-control" id="doc_year" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567, 2566-2570">
                 </div>
             </div>
             
             <div class="mb-2">
                 <label class="small fw-bold">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                 <input type="text" class="form-control" id="doc_desc">
             </div>
             
             <div class="row g-2 mb-2">
                <div class="col-md-6">
                    <label class="small fw-bold">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                    <select class="form-select" id="doc_cat">
                        <option value="General">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
                        <option value="Plan">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤</option>
                        <option value="Report">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•</option>
                        <option value="Announcement">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label class="small fw-bold">AI Chatbot</label>
                    <select class="form-select" id="doc_ai_status">
                        <option value="ON">üü¢ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô AI Chatbot</option>
                        <option value="OFF">üî¥ ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô AI</option>
                    </select>
                </div>
             </div>
             
             <div class="mb-3">
                 <label class="small fw-bold">‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå (URL) <span class="text-danger">*</span></label>
                 <input type="text" class="form-control" id="doc_link" required>
             </div>
             
             <div class="p-3 border rounded bg-white">
                 <div class="row">
                     <div class="col-md-4">
                         <label class="small fw-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö (‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)</label>
                         <input type="number" class="form-control" id="doc_order" placeholder="‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ">
                     </div>
                     <div class="col-md-4 pt-4">
                         <div class="form-check form-switch">
                             <input class="form-check-input" type="checkbox" id="doc_is_pinned">
                             <label class="small fw-bold">üìå ‡∏õ‡∏±‡∏Å‡∏´‡∏°‡∏∏‡∏î‡∏ö‡∏ô‡∏™‡∏∏‡∏î</label>
                         </div>
                     </div>
                     <div class="col-md-4 pt-4">
                         <div class="form-check form-switch">
                             <input class="form-check-input" type="checkbox" id="doc_is_important">
                             <label class="small fw-bold text-danger">‚≠ê ‡∏ï‡∏¥‡∏î‡∏õ‡πâ‡∏≤‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
                         </div>
                     </div>
                 </div>
             </div>
             
             <div class="mt-4 text-end">
                 <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                 <button type="submit" class="btn btn-success fw-bold px-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
             </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="adminVideoModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-dark text-white">
                <h5 class="modal-title fw-bold" id="vidModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form onsubmit="submitVideo(event)">
                    <input type="hidden" id="vid_id">
                    <div class="mb-2"><label class="small fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</label><input type="text" class="form-control" id="vid_title" required></div>
                    <div class="mb-2"><label class="small fw-bold">‡∏•‡∏¥‡∏á‡∏Å‡πå YouTube</label><input type="text" class="form-control" id="vid_link" required></div>
                    <div class="mb-3"><label class="small fw-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö</label><input type="number" class="form-control" id="vid_order" placeholder="‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ"></div>
                    <div class="text-end">
                        <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" class="btn btn-success fw-bold px-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
  </div>

  <div class="modal fade" id="adminQAModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-dark text-white">
                <h5 class="modal-title fw-bold" id="qaModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏° Q&A</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form onsubmit="submitQA(event)">
                    <input type="hidden" id="qa_id">
                    <div class="row g-2 mb-2">
                        <div class="col-3">
                            <label class="small fw-bold">‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô</label>
                            <select class="form-select" id="qa_emoji">
                                <option value="‚ùì">‚ùì</option><option value="üì¢">üì¢</option><option value="üî¥">üî¥</option><option value="üí°">üí°</option>
                            </select>
                        </div>
                        <div class="col-9">
                            <label class="small fw-bold">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</label>
                            <input type="text" class="form-control" id="qa_question" required>
                        </div>
                    </div>
                    <div class="mb-3"><label class="small fw-bold">‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</label><textarea class="form-control" id="qa_answer" rows="4" required></textarea></div>
                    <div class="text-end">
                        <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" class="btn btn-success fw-bold px-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
  </div>

  <script>
    // ==========================================
    // üü¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Javascript) ‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏Å‡∏≤‡∏á 100% üü¢
    // ==========================================
    let docs = [];
    let qaList = [];
    let filteredDocs = [];
    let videoList = [];
    
    let isAdmin = false; 
    let adminToken = "";
    
    let form1Open = true; 
    let form1Title = "";
    let hOpen = true; 
    let hTitle = "";
    let hPlanName = "";
    let hRatingOpen = true;
    
    let currentPage = 1; 
    const itemsPerPage = 10; 
    let currentDocLink = "";

    // üü¢ 1. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Scripts
    function initSystem() { 
      document.getElementById('globalLoader').style.display = 'flex';
      
      Promise.all([
          fetch(SCRIPT_URL + '?action=getSettings').then(r => r.json()), 
          fetch(SCRIPT_URL + '?action=getDocs').then(r => r.json()), 
          fetch(SCRIPT_URL + '?action=getQA').then(r => r.json()), 
          fetch(SCRIPT_URL + '?action=getVideos').then(r => r.json())
      ]).then(([settings, docsData, qaData, vidData]) => {
         
         // 1. ‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£
         form1Open = (settings.form1_status === 'OPEN'); 
         form1Title = settings.form1_title; 
         hOpen = (settings.h_status === 'OPEN'); 
         hTitle = settings.h_title; 
         hPlanName = settings.h_plan_name; 
         hRatingOpen = (settings.h_rating === 'ON');
         
         docs = docsData; 
         qaList = qaData; 
         videoList = vidData;

         // 2. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Home
         document.getElementById('disp_title_1').innerText = form1Title;
         document.getElementById('disp_desc_1').innerText = settings.form1_desc;
         document.getElementById('disp_date_1').innerText = "üìÖ " + settings.form1_date;
         
         if(form1Open) { 
             document.getElementById('banner1').classList.remove('closed'); 
             document.getElementById('statusBadge1').style.display = 'none'; 
         } else { 
             document.getElementById('banner1').classList.add('closed'); 
             document.getElementById('statusBadge1').style.display = 'inline-block'; 
         }

         document.getElementById('disp_title_2').innerText = hTitle;
         document.getElementById('disp_desc_2').innerText = settings.h_desc;
         document.getElementById('disp_date_2').innerText = "üìÖ " + settings.h_date;
         
         if(hOpen) { 
             document.getElementById('banner2').classList.remove('closed'); 
             document.getElementById('statusBadge2').style.display = 'none'; 
         } else { 
             document.getElementById('banner2').classList.add('closed'); 
             document.getElementById('statusBadge2').style.display = 'inline-block'; 
         }

         updateVideo(settings.video_url);

         // 3. ‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡πà‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤
         buildYearFilter(); 
         filterDocs();
         renderQA(); 
         renderVideos();
         
         // 4. ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÇ‡∏´‡∏•‡∏î
         document.getElementById('globalLoader').style.opacity = '0';
         setTimeout(() => { document.getElementById('globalLoader').style.display = 'none'; }, 300);

      }).catch(error => {
          console.error("InitSystem Error:", error);
          document.getElementById('globalLoader').style.display = 'none';
          Swal.fire({
              icon: 'error',
              title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠',
              html: '‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Script ‡πÑ‡∏î‡πâ<br>‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Deploy <b>‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô New Version</b>'
          });
      });
    }

    // üü¢ 2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets ‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö Error ‡∏£‡∏±‡∏î‡∏Å‡∏∏‡∏°
    function postData(data, callback) { 
       fetch(SCRIPT_URL, { 
           method: 'POST', 
           body: JSON.stringify(data) 
       })
       .then(response => response.text())
       .then(text => { 
           try { 
               let json = JSON.parse(text);
               callback(json); 
           } catch(error) { 
               console.error("JSON Parse Error:", text);
               Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå', '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£ Deploy ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô New Version', 'error'); 
           } 
       })
       .catch(error => {
           console.error("Fetch Error:", error);
           Swal.fire('‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠', '‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì', 'error');
       }); 
    }

    // üü¢ 3. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏à
    function toggleSidebar() { 
        document.getElementById('sidebar').classList.toggle('active'); 
        document.getElementById('sidebarOverlay').classList.toggle('active'); 
    }
    
    function showPage(id) {
      let pages = ['page-home','page-docs','page-calendar','page-qa', 'page-videos', 'page-admin-dash'];
      pages.forEach(page => {
          document.getElementById(page).style.display = 'none';
      });
      
      document.getElementById('page-' + id).style.display = 'block';
      
      document.querySelectorAll('.nav-link-main').forEach(el => {
          el.classList.remove('active');
      });
      
      if(id !== 'admin-dash') {
          document.getElementById('menu-' + id).classList.add('active');
      }
      
      if(id === 'docs') filterDocs();
      
      window.scrollTo(0,0);
      
      if(window.innerWidth <= 992) { 
          document.getElementById('sidebar').classList.remove('active'); 
          document.getElementById('sidebarOverlay').classList.remove('active'); 
      }
    }
    function scrollToId(id) { 
        showPage('home'); 
        setTimeout(() => { document.getElementById(id).scrollIntoView({behavior:'smooth'}); }, 200); 
    }

    // üü¢ 4. ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Documents) - ‡πÉ‡∏ä‡πâ Modal ‡∏Ç‡∏≠‡∏á Bootstrap
    function getVal(id) { 
        return document.getElementById(id).value; 
    }

    function openDocModal() { 
        document.getElementById('adminDocForm').reset(); 
        document.getElementById('doc_id').value = ''; 
        document.getElementById('docModalTitle').innerText = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
        
        let modalElement = document.getElementById('adminDocModal');
        let modalInstance = bootstrap.Modal.getInstance(modalElement);
        if (!modalInstance) { modalInstance = new bootstrap.Modal(modalElement); }
        modalInstance.show();
    }
    
    function editDoc(id) {
       let d = docs.find(x => x.id === id); 
       if(!d) return;
       
       document.getElementById('doc_id').value = d.id; 
       document.getElementById('doc_title').value = d.title;
       document.getElementById('doc_year').value = d.year || ''; 
       document.getElementById('doc_desc').value = d.desc;
       document.getElementById('doc_link').value = d.link; 
       document.getElementById('doc_cat').value = d.type;
       document.getElementById('doc_ai_status').value = d.ai_status || 'ON'; 
       document.getElementById('doc_order').value = d.order == 999 ? '' : d.order;
       document.getElementById('doc_is_pinned').checked = d.is_pinned; 
       document.getElementById('doc_is_important').checked = d.is_important;
       
       document.getElementById('docModalTitle').innerText = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£';
       
       let modalElement = document.getElementById('adminDocModal');
       let modalInstance = bootstrap.Modal.getInstance(modalElement);
       if (!modalInstance) { modalInstance = new bootstrap.Modal(modalElement); }
       modalInstance.show();
    }

    function submitDocument(e) {
      e.preventDefault();
      Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
      
      let payload = { 
          action: 'saveDoc', 
          token: adminToken, 
          id: getVal('doc_id'), 
          title: getVal('doc_title'), 
          desc: getVal('doc_desc'), 
          link: getVal('doc_link'), 
          type: getVal('doc_cat'), 
          ai_status: getVal('doc_ai_status'), 
          year: getVal('doc_year'), 
          order: getVal('doc_order'), 
          is_pinned: document.getElementById('doc_is_pinned').checked, 
          is_important: document.getElementById('doc_is_important').checked 
      };
      
      postData(payload, (res) => {
          if(res.status === 'SUCCESS') { 
              let modalElement = document.getElementById('adminDocModal');
              let modalInstance = bootstrap.Modal.getInstance(modalElement);
              if (modalInstance) modalInstance.hide();
              
              Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß', 'success').then(() => initSystem()); 
          } else { 
              Swal.fire('Error', res.message, 'error'); 
          }
      });
    }

    function deleteDoc(id) { 
        Swal.fire({ 
            title: '‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£?', 
            icon: 'warning', 
            showCancelButton: true, 
            confirmButtonText: '‡πÉ‡∏ä‡πà', 
            cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' 
        }).then((result) => { 
            if (result.isConfirmed) { 
                Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); 
                postData({ action: 'deleteDoc', token: adminToken, id: id }, (res) => { 
                    if(res.status === 'SUCCESS') { 
                        Swal.fire('‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(() => initSystem()); 
                    } else { 
                        Swal.fire('Error', res.message, 'error'); 
                    } 
                }); 
            } 
        }); 
    }

    // üü¢ 5. ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á (‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏ö‡∏±‡∏Ñ‡∏Ñ‡πâ‡∏≤‡∏á)
    function buildYearFilter() {
       let years = new Set();
       docs.forEach(d => { 
           if(d.year !== undefined && d.year !== null && d.year !== "") { 
               let yearStr = d.year.toString().trim(); // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô String
               let parts = yearStr.split('-'); 
               if(parts.length === 2 && !isNaN(parts[0]) && !isNaN(parts[1])) { 
                   for(let y = parseInt(parts[0]); y <= parseInt(parts[1]); y++) {
                       years.add(y.toString()); 
                   }
               } else { 
                   years.add(yearStr); 
               } 
           }
       });
       
       let html = '<option value="All">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>';
       let sortedYears = Array.from(years).sort((a,b) => b - a);
       
       sortedYears.forEach(y => {
           html += `<option value="${y}">‡∏õ‡∏µ ${y}</option>`;
       });
       
       document.getElementById('filterYear').innerHTML = html;
    }

    function sortDocsLogic(a, b) {
       if (a.is_pinned !== b.is_pinned) return a.is_pinned ? -1 : 1; 
       
       let getYearMax = (y) => { 
           if(!y) return 0; 
           let p = y.toString().split('-'); 
           return p.length === 2 ? parseInt(p[1]) : parseInt(y); 
       };
       let yA = getYearMax(a.year);
       let yB = getYearMax(b.year);
       if (yA !== yB) return yB - yA;
       
       let oA = a.order || 999;
       let oB = b.order || 999;
       if (oA !== oB) return oA - oB;
       
       return new Date(b.created) - new Date(a.created);
    }

    function filterDocs() {
       let searchText = getVal('searchDoc').toLowerCase();
       let catFilter = getVal('filterCat');
       let yearFilter = getVal('filterYear');
       
       filteredDocs = docs.filter(d => {
          let mTxt = d.title.toLowerCase().includes(searchText) || (d.desc && d.desc.toLowerCase().includes(searchText));
          let mCat = (catFilter === 'All') || (d.type === catFilter); 
          
          let mYr = (yearFilter === 'All');
          if (!mYr && d.year) { 
              let docYr = d.year.toString().trim();
              let p = docYr.split('-'); 
              if (p.length === 2) { 
                  mYr = (parseInt(yearFilter) >= parseInt(p[0]) && parseInt(yearFilter) <= parseInt(p[1])); 
              } else { 
                  mYr = (yearFilter === docYr); 
              } 
          }
          
          return mTxt && mCat && mYr;
       });
       
       filteredDocs.sort(sortDocsLogic); 
       currentPage = 1; 
       renderDocs();
    }
    
    function clearSearch() { 
        document.getElementById('searchDoc').value = ''; 
        document.getElementById('filterCat').value = 'All'; 
        document.getElementById('filterYear').value = 'All'; 
        filterDocs(); 
    }

    function getCatBadge(type) { 
        let label = type, colorClass = 'bg-secondary'; 
        switch(type) { 
            case 'General': label = '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ'; break; 
            case 'Plan': label = '‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤'; colorClass = 'bg-primary'; break; 
            case 'Report': label = '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•'; colorClass = 'bg-success'; break; 
            case 'Announcement': label = '‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á'; colorClass = 'bg-warning text-dark'; break; 
        } 
        return `<span class="badge ${colorClass}">${label}</span>`; 
    }

    // üü¢ 6. ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏à‡∏±‡∏î‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà)
    function renderDocs() {
      let html = ''; 
      if(filteredDocs.length === 0) { 
          html = '<div class="text-center text-muted py-5">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>'; 
          document.getElementById('pagination').innerHTML=''; 
      } else {
        let start = (currentPage - 1) * itemsPerPage;
        let end = start + itemsPerPage;
        let paginatedItems = filteredDocs.slice(start, end);
        
        paginatedItems.forEach(doc => {
          let icon = 'description', color = 'text-primary'; 
          if(doc.link.includes('drive')) { icon = 'add_to_drive'; color = 'text-success'; } 
          else if(doc.link.includes('.pdf')) { icon = 'picture_as_pdf'; color = 'text-danger'; }
          
          let dateStr = "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: " + formatDate(doc.created); 
          
          let badges = '';
          if(doc.is_pinned) badges += `<span class="badge badge-pin me-2">üìå ‡∏õ‡∏±‡∏Å‡∏´‡∏°‡∏∏‡∏î</span>`;
          if(doc.is_important) badges += `<span class="badge bg-danger me-2">‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</span>`;
          
          // üåü ‡∏õ‡πâ‡∏≤‡∏¢ NEW ‡πÅ‡∏ö‡∏ö‡∏û‡∏¥‡πÄ‡∏®‡∏© üåü
          let ageDays = (new Date() - new Date(doc.created)) / (1000 * 60 * 60 * 24);
          if(ageDays < 14) badges += `<span class="badge-custom-new me-2">NEW</span>`;

          // üóìÔ∏è ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏ß‡∏≤‡∏á‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì üóìÔ∏è
          let catBadge = getCatBadge(doc.type);
          let yrBadge = doc.year ? `<span class="badge bg-info text-dark ms-2"><i class="material-icons align-middle" style="font-size: 11px;">event</i> ‡∏õ‡∏µ ${doc.year}</span>` : '';

          let editBtn = isAdmin ? `<button class="btn btn-sm btn-outline-warning ms-2" onclick="editDoc('${doc.id}')">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>` : ''; 
          let deleteBtn = isAdmin ? `<button class="btn btn-sm btn-outline-danger ms-2" onclick="deleteDoc('${doc.id}')">‡∏•‡∏ö</button>` : '';
          let chatBtn = doc.ai_status === 'OFF' ? `<button class="btn btn-sm btn-secondary text-white opacity-50" style="cursor:not-allowed;"><i class="material-icons align-middle" style="font-size:16px;">smart_toy</i> ‡∏õ‡∏¥‡∏î AI</button>` : `<button class="btn btn-sm btn-info text-white" onclick="openChat('${doc.id}')"><i class="material-icons align-middle" style="font-size:16px;">smart_toy</i> ‡∏ñ‡∏≤‡∏° AI</button>`;
          
          html += `
            <div class="list-group-item list-group-item-action d-flex align-items-start py-4 px-3 border-bottom">
                <i class="material-icons fs-2 me-4 mt-1 ${color}">${icon}</i>
                <div class="flex-grow-1">
                    <a href="${doc.link}" target="_blank" class="text-decoration-none text-dark">
                        <div class="mb-1 d-flex align-items-center flex-wrap">${badges}</div>
                        <h5 class="mb-2 fw-bold">${doc.title}</h5>
                        <div class="mb-2 d-flex flex-wrap align-items-center">
                            ${catBadge} ${yrBadge} 
                            <span class="text-muted small ms-md-2 mt-2 mt-md-0 d-block d-md-inline w-100 w-md-auto">${doc.desc || ""}</span>
                        </div>
                        <small class="text-secondary">${dateStr}</small>
                    </a>
                </div>
                <div class="d-flex align-items-center ms-3">
                    ${chatBtn} ${editBtn} ${deleteBtn}
                </div>
            </div>`;
        });
        renderPagination();
      } 
      document.getElementById('docListContainer').innerHTML = html;
    }

    function renderPagination() { 
        let totalPages = Math.ceil(filteredDocs.length / itemsPerPage); 
        let html = ''; 
        if(totalPages > 1) { 
            html += `<div class="page-btn ${currentPage===1 ? 'disabled' : ''}" onclick="changePage(${currentPage-1})">¬´</div>`; 
            for(let i=1; i<=totalPages; i++) { 
                if(i===1 || i===totalPages || (i>=currentPage-1 && i<=currentPage+1)) { 
                    html += `<div class="page-btn ${i===currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</div>`; 
                } else if(i===currentPage-2 || i===currentPage+2) { 
                    html += `<span class="px-2">...</span>`; 
                } 
            } 
            html += `<div class="page-btn ${currentPage===totalPages ? 'disabled' : ''}" onclick="changePage(${currentPage+1})">¬ª</div>`; 
        } 
        document.getElementById('pagination').innerHTML = html; 
    }
    
    function changePage(p) { 
        let totalPages = Math.ceil(filteredDocs.length / itemsPerPage); 
        if(p < 1 || p > totalPages) return; 
        currentPage = p; 
        renderDocs(); 
    }

    // üü¢ 7. ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Admin Login, Banners, Form Submits)
    function formatDate(isoStr) { 
        if(!isoStr) return ""; 
        let d = new Date(isoStr); 
        return d.toLocaleDateString('th-TH') + ' ' + d.toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'}); 
    }
    
    function updateVideo(url) { 
        let id = url ? (url.split('v=')[1] || url.split('/').pop()) : ""; 
        document.getElementById('main_video_frame').src = "https://www.youtube.com/embed/" + id; 
    }

    function loginToggle() {
       if(isAdmin) { return logoutSystem(); }
       Swal.fire({ 
           title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin', 
           html: '<input id="swal-u" class="swal2-input" placeholder="Username"><input id="swal-p" class="swal2-input" type="password" placeholder="Password">', 
           showCancelButton: true,
           preConfirm: () => [getVal('swal-u'), getVal('swal-p')] 
       }).then((result) => { 
           if (result.isConfirmed) { 
               if (!result.value[0] || !result.value[1]) return Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö', 'warning');
               
               Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...', didOpen: () => Swal.showLoading() }); 
               
               postData({action: 'login', username: result.value[0], password: result.value[1]}, (data) => { 
                   if(data.status === 'SUCCESS') { 
                       adminToken = result.value[1]; 
                       setAdminMode(true); 
                       Swal.fire('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '', 'success'); 
                   } else { 
                       Swal.fire('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error'); 
                   } 
               }); 
           } 
       });
    }

    function logoutSystem() { 
        Swal.fire({ 
            title: '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?', 
            showCancelButton: true,
            confirmButtonText: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö'
        }).then((result) => { 
            if(result.isConfirmed) { 
                adminToken = ""; 
                setAdminMode(false); 
                Swal.fire('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß', '', 'success'); 
            } 
        }); 
    }

    function setAdminMode(status) { 
        isAdmin = status; 
        document.getElementById('adminHomePanel').style.display = status ? 'block' : 'none'; 
        
        ['adminDocBtnGroup','adminMenuSection', 'adminVideoBtnGroup', 'adminQABtnGroup'].forEach(id => {
            let element = document.getElementById(id);
            if (element) { element.style.display = status ? 'flex' : 'none'; }
        });
        
        filterDocs(); 
        renderQA(); 
        renderVideos();
    }

    // Modal Forms Openers
    function handleBannerClick(num) { 
        if(num === 1) { 
            if(form1Open) { 
                document.getElementById('formTitle').innerText = form1Title; 
                document.getElementById('f_topic_type').value = form1Title; 
                document.getElementById('topicSelectDiv').style.display = 'block'; 
                
                let modalElement = document.getElementById('formModal');
                let modalInstance = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
                modalInstance.show();
            } else { 
                Swal.fire('‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß'); 
            } 
        } else if (num === 2) { 
            if(hOpen) { 
                let modalElement = document.getElementById('hearingModal');
                let modalInstance = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
                modalInstance.show();
            } else { 
                Swal.fire('‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô'); 
            } 
        } 
    }
    
    // ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ Modals
    function openVideoModal() {
        document.getElementById('vid_id').value = ''; 
        document.getElementById('vid_title').value = ''; 
        document.getElementById('vid_link').value = ''; 
        document.getElementById('vid_order').value = ''; 
        document.getElementById('vidModalTitle').innerText = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠';
        let modalElement = document.getElementById('adminVideoModal');
        let modalInstance = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
        modalInstance.show();
    }

    // QA Modals
    function openQAModal() {
        document.getElementById('qa_id').value = ''; 
        document.getElementById('qa_emoji').value = '‚ùì'; 
        document.getElementById('qa_question').value = ''; 
        document.getElementById('qa_answer').value = ''; 
        document.getElementById('qaModalTitle').innerText = '‡πÄ‡∏û‡∏¥‡πà‡∏° Q&A';
        let modalElement = document.getElementById('adminQAModal');
        let modalInstance = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
        modalInstance.show();
    }
  </script>
</body>
</html>
