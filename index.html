<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>S-MAP Chiang Mai (Smart Movement & Awareness Platform)</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    /* ================= CSS ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ================= */
    * { box-sizing: border-box; }
    body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; overflow-x: hidden; }
    
    /* ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÇ‡∏´‡∏•‡∏î (Loader) */
    #globalLoader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffffff; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.3s ease; }
    .loader-spinner { width: 60px; height: 60px; margin-bottom: 20px; border: 6px solid #f3f3f3; border-top: 6px solid #0d6efd; border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* ================= Header ================= */
    .main-header { background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Doi_Suthep_02.jpg/1200px-Doi_Suthep_02.jpg') center center/cover no-repeat; color: white; position: relative; padding: 0; min-height: 250px; display: flex; align-items: center; }
    .header-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, rgba(13, 110, 253, 0.92) 0%, rgba(0, 50, 133, 0.85) 100%); z-index: 1; }
    .header-content { position: relative; z-index: 2; width: 100%; padding: 40px; display: flex; align-items: center; justify-content: center; }
    
    /* ‡∏õ‡∏∏‡πà‡∏° Sidebar Toggle ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏∂‡∏á‡πÑ‡∏ß‡πâ‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô */
    .sidebar-toggle-btn { position: absolute; top: 25px; left: 25px; z-index: 1050; color: white; border-radius: 8px; cursor: pointer; padding: 5px 10px; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.4); backdrop-filter: blur(5px); }
    .sidebar-toggle-btn:hover { background: rgba(255,255,255,0.3); }

    .header-icon-box { margin-right: 30px; }
    .org-title-group { display: flex; flex-direction: column; justify-content: center; text-align: left; }
    .org-top-text { font-weight: 400; font-size: 1.4rem; color: #ffeb3b; letter-spacing: 1px; }
    .org-main-text { font-weight: 700; font-size: 2.2rem; line-height: 1.2; text-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    .eng-subtitle { font-weight: 300; opacity: 0.9; font-size: 1rem; margin-top: 5px; }

    @media (max-width: 992px) { 
      .header-content { flex-direction: column; text-align: center; padding-top: 90px; }
      .header-icon-box { margin-right: 0; margin-bottom: 15px; }
      .org-title-group { text-align: center; }
      .org-main-text { font-size: 1.6rem; }
      .sidebar-toggle-btn { top: 15px !important; left: 15px !important; }
    }
    
    /* ================= Sidebar & Layout ================= */
    .wrapper { display: flex; width: 100%; align-items: flex-start; }
    .sidebar { min-width: 260px; max-width: 260px; background: white; border-right: 1px solid #e9ecef; position: sticky; top: 0; height: 100vh; overflow-y: auto; z-index: 1000; transition: all 0.3s; }
    @media (max-width: 992px) { .sidebar { position: fixed; left: -260px; top: 0; } .sidebar.active { left: 0; box-shadow: 4px 0 15px rgba(0,0,0,0.15); } .overlay { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 998; } .overlay.active { display: block; } }
    
    .nav-link-main { padding: 15px 25px; color: #0d6efd; font-weight: 700; cursor: pointer; display: block; text-decoration: none; border-bottom: 1px solid #f8f9fa; transition: 0.2s; }
    .nav-link-main:hover, .nav-link-main.active { background-color: #e7f1ff; border-left: 5px solid #0d6efd; padding-left: 30px; }
    .nav-link-sub { padding: 10px 25px 10px 50px; color: #6c757d; cursor: pointer; display: block; text-decoration: none; font-size: 0.9rem; transition: 0.2s; }
    .nav-link-sub:hover { color: #0d6efd; background-color: #f8f9fa; transform: translateX(5px); }
    
    /* ================= Content Area ================= */
    .main-content { width: 100%; padding: 20px; min-height: 100vh; background-color: #f0f2f5; flex-grow: 1; }
    .content-section { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); margin-bottom: 25px; }
    .section-header { padding-bottom: 10px; margin-bottom: 20px; color: #0d6efd; font-weight: 700; border-bottom: 2px solid #f0f0f0; }
    
    /* ‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å */
    .banner-btn { display: flex; align-items: center; padding: 20px; margin-bottom: 20px; border-radius: 15px; color: white; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: none; width: 100%; text-align: left; }
    .banner-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
    .banner-icon { flex: 0 0 80px; font-size: 3.5rem; margin-right: 20px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border-radius: 50%; width: 80px; height: 80px; }
    .banner-title { font-weight: 800; font-size: clamp(1.2rem, 2vw, 1.6rem); margin-bottom: 5px; line-height: 1.2; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    .banner-desc { font-size: 1rem; opacity: 0.95; font-weight: 400; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .bg-gradient-pink { background: linear-gradient(135deg, #ff7eb3 0%, #ff758c 100%); }
    .bg-gradient-yellow { background: linear-gradient(135deg, #fce38a 0%, #f38181 100%); color: #4a4a4a !important; }
    .banner-btn.closed { filter: grayscale(100%); opacity: 0.7; background: #636e72 !important; cursor: not-allowed; pointer-events: none; }
    .status-badge { font-size: 0.8rem; padding: 4px 10px; border-radius: 20px; background: white; color: #d63031; font-weight: bold; }
    .date-badge { font-size: 0.85rem; padding: 4px 10px; border-radius: 20px; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.5); }
    
    /* ================= üåü ‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö (Badges) ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà ================= */
    .badge-pin { background-color: #34495e; color: white; font-weight: bold; }
    
    /* ‡∏õ‡πâ‡∏≤‡∏¢ NEW: ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏µ‡∏ó‡∏≠‡∏á ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡πÅ‡∏î‡∏á */
    .badge-custom-new { 
        display: inline-block;
        background-color: transparent; 
        color: #FFD700; /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ó‡∏≠‡∏á */
        -webkit-text-stroke: 0.8px #ffb300; /* ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏° */
        text-shadow: 1px 1px 0px #ffff00, -1px -1px 0px #ffff00, 1px -1px 0px #ffff00, -1px 1px 0px #ffff00; /* ‡πÄ‡∏á‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏±‡∏ô‡∏Ç‡∏≠‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô */
        font-weight: 900; 
        font-size: 0.8rem;
        letter-spacing: 0.5px;
        padding: 3px 10px;
        border-radius: 20px;
        border: 2px solid #ff0000; /* ‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡∏µ‡πÅ‡∏î‡∏á */
        animation: pulse-red-border 1.2s infinite; /* ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡πÅ‡∏ß‡∏ö‡πÜ */
    }
    @keyframes pulse-red-border { 
        0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); } 
        70% { box-shadow: 0 0 0 8px rgba(255, 0, 0, 0); } 
        100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); } 
    }

    /* ================= ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ ================= */
    .page-btn { border: 1px solid #dee2e6; background: white; color: #0d6efd; padding: 5px 12px; cursor: pointer; border-radius: 5px; transition: 0.2s; }
    .page-btn.active { background: #0d6efd; color: white; border-color: #0d6efd; }
    .page-btn.disabled { opacity: 0.5; cursor: not-allowed; }
    
    .chat-container { height: 400px; overflow-y: auto; border: 1px solid #eee; background: #f8f9fa; padding: 15px; border-radius: 10px; display: flex; flex-direction: column; gap: 10px; }
    .chat-msg { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 0.95rem; line-height: 1.5; word-wrap: break-word; }
    .chat-user { align-self: flex-end; background-color: #0d6efd; color: white; border-bottom-right-radius: 2px; }
    .chat-ai { align-self: flex-start; background-color: white; color: #333; border: 1px solid #e0e0e0; border-bottom-left-radius: 2px; }
    .chat-ai strong { color: #0d6efd; }
    
    .video-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; transition: transform 0.2s; border: 1px solid #eee; }
    .video-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.15); }
    .video-title-bar { padding: 12px 15px; background: #f8f9fa; border-bottom: 1px solid #eee; font-weight: bold; color: #333; font-size: 0.95rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
    .video-title-text { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; flex-grow: 1; padding-right: 10px; }
    
    .dash-card { border-left: 5px solid; transition: transform 0.2s; }
    .dash-icon { width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white; }
    .dash-num { font-size: 2rem; font-weight: bold; line-height: 1.2; }
    
    .star-rating i { font-size: 2.5rem; color: #ccc; cursor: pointer; transition: color 0.2s; }
    .star-rating i.hover { color: #f1c40f; opacity: 0.5; }
    .star-rating i.active { color: #f39c12; }

    .floating-menu-btn { position: fixed; bottom: 30px; right: 20px; width: 55px; height: 55px; background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%); color: white; border-radius: 50%; border: none; box-shadow: 0 4px 15px rgba(13, 110, 253, 0.4); display: flex; align-items: center; justify-content: center; z-index: 997; cursor: pointer; transition: all 0.3s ease; }
    
    /* Footer */
    .main-footer { background-color: #1a1d20; color: #cfd2d6; padding: 60px 40px; margin-top: auto; border-top: 5px solid #0d6efd; }
    .footer-title { color: white; font-weight: 700; margin-bottom: 20px; border-left: 4px solid #0d6efd; padding-left: 10px; }
    .admin-link-container { margin-top: 20px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); }
    .admin-trigger { color: #6c757d; font-size: 0.8rem; text-decoration: none; cursor: pointer; transition: color 0.3s; }
    .admin-trigger:hover { color: #ffffff; text-decoration: underline; }
  </style>
</head>
<body onload="initSystem()">

  <div id="globalLoader">
    <div class="loader-content text-center">
      <div class="loader-spinner mx-auto"></div>
      <h5 class="text-primary fw-bold">‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° S-MAP Chiang Mai</h5>
      <div class="text-muted small">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°...</div>
    </div>
  </div>

  <script>
    // üö® ‡∏•‡∏¥‡∏á‡∏Å‡πå API ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwGWDn2t6cPkNDJyuYN_RXvBfB_m7MM1gdHs4-QVKLhRWOhkDjbxeOQxoAc3ZKoJaZFEg/exec"; 
  </script>

  <header class="main-header container-fluid">
    <div class="header-overlay"></div>
    <button class="sidebar-toggle-btn d-lg-none" onclick="toggleSidebar()"><i class="material-icons">menu</i></button>
    
    <div class="header-content">
      <div class="header-icon-box d-none d-md-block"><i class="material-icons" style="font-size: 5.5rem;">account_balance</i></div> 
      <div class="org-title-group">
        <div class="org-top-text">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</div>
        <h1 class="m-0 org-main-text">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h1>
        <div class="eng-subtitle">Strategy and Information for Provincial Development</div>
      </div>
    </div>
  </header>

  <button class="floating-menu-btn d-lg-none" onclick="toggleSidebar()"><i class="material-icons">menu</i></button>

  <div class="wrapper">
    <div class="overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <nav class="sidebar" id="sidebar">
      <div class="flex-grow-1 pt-4">
        <h6 class="px-3 text-secondary fw-bold mb-3" style="font-size: 0.8rem; letter-spacing: 1px;">MENU</h6>
        <a class="nav-link-main active" id="menu-home" onclick="showPage('home')">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <div id="sub-home">
          <a class="nav-link-sub" onclick="scrollToId('section-video')">‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-feedback')">‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-dash')">üìçDashboard</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-pr')">‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-facebook')">‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</a>
        </div>
        <a class="nav-link-main" id="menu-videos" onclick="showPage('videos')">‚ñ∂Ô∏è ‡∏Ñ‡∏•‡∏±‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</a>
        <a class="nav-link-main" id="menu-docs" onclick="showPage('docs')">üìÇ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
        <a class="nav-link-main" id="menu-calendar" onclick="showPage('calendar')">üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</a>
        <a class="nav-link-main" id="menu-qa" onclick="showPage('qa')">‚ùì ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A)</a>

        <div id="adminMenuSection" style="display:none;">
            <hr class="mx-3 border-secondary">
            <h6 class="px-3 text-danger fw-bold mt-2">ADMINISTRATOR</h6>
            <a class="nav-link-main text-danger" onclick="showPage('admin-dash')">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin)</a>
        </div>
      </div>
    </nav>

    <div class="main-content">
      
      <div id="page-home">
        
        <div id="section-video" class="content-section text-center">
          <h3 class="section-header" id="disp_video_title">üì∫ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
          <div class="ratio ratio-16x9 w-100 mx-auto shadow rounded overflow-hidden" style="max-width: 850px;"><iframe id="main_video_frame" src="" allowfullscreen></iframe></div>
          <div class="mt-4"><button onclick="showPage('videos')" class="btn btn-outline-primary fw-bold rounded-pill px-4">‚ñ∂Ô∏è ‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (Click Here)</button></div>
        </div>

        <div id="adminHomePanel" class="content-section bg-warning-subtle border-warning border border-2" style="display:none;">
          <div class="d-flex justify-content-between align-items-center border-bottom border-warning pb-2">
             <h5 class="fw-bold m-0 text-dark"><i class="material-icons align-middle text-success">verified_user</i> ‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h5>
             <button class="btn btn-sm btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle fs-6">logout</i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
          </div>
          
          <div class="mt-3 bg-white p-3 rounded shadow-sm border-start border-4 border-danger">
             <h6 class="fw-bold text-danger mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π)</h6>
             <div class="row">
                 <div class="col-md-6 mb-2"><label class="small fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠:</label><input type="text" id="admin_title_1" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small fw-bold">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:</label><input type="text" id="admin_subtitle_1" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label><input type="text" id="admin_date_1" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2 d-flex align-items-end"><div class="form-check form-switch bg-light p-2 rounded w-100 border"><label class="form-check-label fw-bold">‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á</label><input class="form-check-input float-end" type="checkbox" id="swForm1"></div></div>
             </div>
             <button class="btn btn-sm btn-outline-danger w-100 mt-2" onclick="saveFormConfig()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
          </div>

          <div class="mt-3 bg-white p-3 rounded shadow-sm border-start border-4 border-warning">
             <h6 class="fw-bold text-warning text-dark mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: ‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô (‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á)</h6>
             <div class="mb-3 p-2 bg-warning bg-opacity-10 border rounded">
                 <label class="small text-dark fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤:</label>
                 <input type="text" id="h_admin_plan_name" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏û.‡∏®. 2566 - 2570">
             </div>
             <div class="row bg-light p-2 rounded mb-3 border">
                 <div class="col-md-6 mb-2"><label class="small fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏•‡πà‡∏≠‡∏á:</label><input type="text" id="h_admin_title" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small fw-bold">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏•‡πà‡∏≠‡∏á:</label><input type="text" id="h_admin_desc" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2"><label class="small fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label><input type="text" id="h_admin_date" class="form-control form-control-sm"></div>
                 <div class="col-md-6 mb-2 d-flex gap-2">
                     <div class="form-check form-switch w-50 p-2 border rounded bg-white"><label class="small">‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á</label><input class="form-check-input float-end" type="checkbox" id="swHearingStatus"></div>
                     <div class="form-check form-switch w-50 p-2 border rounded bg-white"><label class="small">‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏≤‡∏ß</label><input class="form-check-input float-end" type="checkbox" id="swHearingRating"></div>
                 </div>
             </div>
             <div class="mb-3 p-2 border rounded border-primary border-opacity-25 bg-white">
                 <label class="fw-bold text-primary small mb-2">‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ô‡∏ö</label>
                 <div class="input-group input-group-sm mb-2"><span class="input-group-text bg-light">‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå</span><input type="text" class="form-control" id="h_admin_img" placeholder="URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"></div>
                 <div class="mb-2"><input type="text" class="form-control form-control-sm" id="h_admin_info_title" placeholder="‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á"></div>
                 <div class="mb-2"><textarea class="form-control form-control-sm" id="h_admin_info_desc" rows="3" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á..."></textarea></div>
                 <div class="input-group input-group-sm mb-1"><span class="input-group-text bg-light">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡πà‡∏≠</span><input type="text" class="form-control" id="h_admin_sum" placeholder="URL ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ"></div>
                 <div class="input-group input-group-sm mb-1"><span class="input-group-text bg-light">‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ú‡∏ô‡πÄ‡∏ï‡πá‡∏°</span><input type="text" class="form-control" id="h_admin_full" placeholder="URL ‡∏£‡πà‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°"></div>
             </div>
             <div class="mb-3 p-2 border rounded border-success border-opacity-25 bg-white">
                 <label class="fw-bold text-success small mb-2">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</label>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q1" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 1"></div>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q2" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 2"></div>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q3" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 3"></div>
                 <div class="ps-3 mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_s3_1" placeholder="‡∏¢‡πà‡∏≠‡∏¢ 1 (‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à)"></div>
                 <div class="ps-3 mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_s3_2" placeholder="‡∏¢‡πà‡∏≠‡∏¢ 2 (‡∏™‡∏±‡∏á‡∏Ñ‡∏°)"></div>
                 <div class="ps-3 mb-2"><input type="text" class="form-control form-control-sm" id="h_admin_s3_3" placeholder="‡∏¢‡πà‡∏≠‡∏¢ 3 (‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°)"></div>
                 <div class="mb-1"><input type="text" class="form-control form-control-sm" id="h_admin_q4" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 4"></div>
             </div>
             <button class="btn btn-sm btn-warning w-100 fw-bold" onclick="saveHearingConfig()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</button>
          </div>

          <div class="mt-3 bg-white p-3 rounded shadow-sm border-start border-4 border-info">
             <h6 class="fw-bold text-info mb-3">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h6>
             <div class="mb-2"><label class="small fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠:</label><input type="text" id="admin_video_title" class="form-control form-control-sm"></div>
             <div class="mb-2"><label class="small fw-bold">URL ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠:</label><input type="text" id="admin_video_url" class="form-control form-control-sm"></div>
             <div class="mb-2"><label class="small fw-bold">URL Dashboard:</label><input type="text" id="admin_dash_url" class="form-control form-control-sm"></div>
             <button class="btn btn-sm btn-outline-info w-100 mt-2" onclick="saveGeneralConfig()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
          </div>
        </div>

        <div id="sec-feedback" class="content-section">
          <h3 class="fw-bold mb-4 text-center">üì¢ ‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
          <div class="row justify-content-center">
            <div class="col-lg-10 mb-4">
              <div id="banner1" class="banner-btn bg-gradient-pink closed" onclick="handleBannerClick(1)">
                <div class="banner-icon"><i class="material-icons">assignment</i></div>
                <div class="banner-text">
                   <div class="banner-title" id="disp_title_1">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                   <div class="banner-desc" id="disp_desc_1">...</div>
                   <div class="mt-2"><span id="statusBadge1" class="status-badge" style="display:none;">‚õî ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á</span><span class="date-badge" id="disp_date_1">...</span></div>
                </div>
              </div>
            </div>

            <div class="col-lg-10 mb-3">
              <div id="banner2" class="banner-btn bg-gradient-yellow closed" onclick="handleBannerClick(2)">
                <div class="banner-icon"><i class="material-icons">groups</i></div>
                <div class="banner-text">
                   <div class="banner-title" id="disp_title_2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                   <div class="banner-desc" id="disp_desc_2">...</div>
                   <div class="mt-2"><span id="statusBadge2" class="status-badge" style="display:none;">‚õî ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô</span><span class="date-badge" id="disp_date_2">...</span></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="sec-dash" class="content-section text-center">
          <h4 class="text-primary mb-4 fw-bold">üìä Dashboard ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
          <div class="ratio ratio-16x9 w-100 border rounded shadow-sm bg-light overflow-hidden">
             <div id="dash_placeholder" class="d-flex flex-column align-items-center justify-content-center h-100 text-muted"><i class="material-icons fs-1 mb-2">bar_chart</i>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î Dashboard...</div>
             <iframe id="main_dash_frame" src="" allowfullscreen style="display:none;"></iframe>
          </div>
        </div>

        <div id="sec-pr" class="content-section">
          <h4 class="text-primary mb-4 fw-bold"><i class="material-icons align-middle">campaign</i> ‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (Info-Graphics)</h4>
          <div id="prCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="0" class="active"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="1"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="2"></button>
            </div>
            <div class="carousel-inner">
              <div class="carousel-item active" data-bs-interval="4000"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Doi_Suthep_02.jpg/1280px-Doi_Suthep_02.jpg"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://thailandtourismdirectory.go.th/assets/upload/2018/01/22/2018012216262947119e830f576313.jpg"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Chiang_Mai_Night_Bazaar.jpg/1280px-Chiang_Mai_Night_Bazaar.jpg"></div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#prCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon bg-dark rounded-circle p-2"></span></button>
            <button class="carousel-control-next" type="button" data-bs-target="#prCarousel" data-bs-slide="next"><span class="carousel-control-next-icon bg-dark rounded-circle p-2"></span></button>
          </div>
        </div>

        <div id="sec-facebook" class="content-section">
          <h4 class="text-primary mb-4 fw-bold"><i class="material-icons align-middle">newspaper</i> ‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (Facebook)</h4>
          <div class="bg-white rounded shadow-sm border p-3 text-center">
            <iframe src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2FChiangmaioffice&tabs=timeline&width=500&height=400&small_header=true&adapt_container_width=true&hide_cover=false&show_facepile=false" width="100%" height="400" style="border:none; overflow:hidden; max-width: 500px;" scrolling="no" frameborder="0" allowfullscreen="true" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
            <div class="mt-3"><a href="https://www.facebook.com/Chiangmaioffice" target="_blank" class="btn btn-outline-primary btn-sm rounded-pill px-4">‡∏î‡∏π‡∏Ç‡πà‡∏≤‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ö‡∏ô Facebook</a></div>
          </div>
        </div>

      </div>

      <div id="page-docs" style="display:none;">
        <div class="content-section">
          <div class="d-flex justify-content-between align-items-center mb-3">
             <h3 class="section-header m-0 border-0 pb-0">üìÇ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h3>
             <div id="adminDocBtnGroup" style="display:none; gap: 8px;">
                 <button class="btn btn-primary fw-bold" onclick="openDocModal()"><i class="material-icons align-middle">add</i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
                 <button class="btn btn-danger fw-bold" onclick="logoutSystem()" title="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö"><i class="material-icons align-middle">logout</i></button>
             </div>
          </div>
          
          <div class="row g-2 mb-4 align-items-center p-3 bg-light rounded border">
             <div class="col-md-4"><label class="small fw-bold mb-1">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label><input type="text" id="searchDoc" class="form-control" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£..." oninput="filterDocs()"></div>
             <div class="col-md-3"><label class="small fw-bold mb-1">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label><select id="filterCat" class="form-select" onchange="filterDocs()"><option value="All">‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option><option value="General">‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option><option value="Plan">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤</option><option value="Report">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•</option><option value="Announcement">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</option></select></div>
             <div class="col-md-3"><label class="small fw-bold mb-1">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label><select id="filterYear" class="form-select" onchange="filterDocs()"><option value="All">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option></select></div>
             <div class="col-md-2 mt-auto"><button class="btn btn-secondary w-100 d-flex justify-content-center align-items-center" onclick="clearSearch()"><i class="material-icons me-1" style="font-size:18px;">refresh</i> ‡∏•‡πâ‡∏≤‡∏á</button></div>
          </div>

          <div class="text-muted small mb-3"><b>* ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</b> ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ AI ‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á</div>
          <div id="docListContainer" class="list-group list-group-flush border rounded shadow-sm"></div>
          <div id="pagination" class="pagination-container"></div>
        </div>
      </div>

      <div id="page-admin-dash" style="display:none;">
          <div class="content-section">
             <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
                 <h3 class="m-0 fw-bold text-dark"><i class="material-icons align-middle text-danger">analytics</i> ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin)</h3>
                 <div>
                    <a id="btnOpenSheet" href="#" target="_blank" class="btn btn-success fw-bold me-2"><i class="material-icons align-middle">table_view</i> ‡πÄ‡∏õ‡∏¥‡∏î Sheets</a>
                    <button class="btn btn-outline-secondary" onclick="loadDashboard()"><i class="material-icons align-middle">refresh</i> ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î</button>
                 </div>
             </div>
             
             <h5 class="fw-bold text-danger mb-3">1. ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h5>
             <div class="row g-3 mb-5">
                 <div class="col-md-4"><div class="card shadow-sm h-100 dash-card" style="border-left-color: #e91e63;"><div class="card-body d-flex align-items-center"><div class="dash-icon bg-danger me-3"><i class="material-icons">assignment_late</i></div><div><div class="text-muted small fw-bold">‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div class="dash-num text-danger" id="stat_issues_total">0</div></div></div></div></div>
                 <div class="col-md-8"><div class="card shadow-sm h-100"><div class="card-body p-2"><canvas id="chartIssues" style="max-height: 200px;"></canvas></div></div></div>
             </div>

             <h5 class="fw-bold text-warning text-dark mb-3">2. ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</h5>
             <div class="row g-3">
                 <div class="col-md-3"><div class="card shadow-sm h-100 dash-card" style="border-left-color: #f1c40f;"><div class="card-body d-flex align-items-center"><div class="dash-icon bg-warning text-dark me-3"><i class="material-icons">groups</i></div><div><div class="text-muted small fw-bold">‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°</div><div class="dash-num text-dark" id="stat_hearing_total">0</div></div></div></div></div>
                 <div class="col-md-9"><div class="row g-3"><div class="col-md-6"><div class="card shadow-sm h-100 border-0"><div class="card-body p-2"><h6 class="text-center small fw-bold text-muted">‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô</h6><canvas id="chartSector" style="max-height: 180px;"></canvas></div></div></div><div class="col-md-6"><div class="card shadow-sm h-100 border-0"><div class="card-body p-2"><h6 class="text-center small fw-bold text-muted">‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå</h6><canvas id="chartVision" style="max-height: 180px;"></canvas></div></div></div></div></div>
             </div>
             <div class="row g-3 mt-1">
                 <div class="col-md-4"><div class="card shadow-sm border-0"><div class="card-body p-2"><h6 class="text-center small fw-bold text-dark">‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à</h6><canvas id="chartEcon" style="max-height: 180px;"></canvas></div></div></div>
                 <div class="col-md-4"><div class="card shadow-sm border-0"><div class="card-body p-2"><h6 class="text-center small fw-bold text-dark">‡∏™‡∏±‡∏á‡∏Ñ‡∏°</h6><canvas id="chartSocial" style="max-height: 180px;"></canvas></div></div></div>
                 <div class="col-md-4"><div class="card shadow-sm border-0"><div class="card-body p-2"><h6 class="text-center small fw-bold text-dark">‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</h6><canvas id="chartEnv" style="max-height: 180px;"></canvas></div></div></div>
             </div>
             <div class="card shadow-sm mt-3"><div class="card-body p-3"><h6 class="small fw-bold text-dark">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h6><canvas id="chartPriority" style="max-height: 200px;"></canvas></div></div>
          </div>
      </div>

      <div id="page-videos" style="display:none;">
        <div class="content-section">
          <div class="d-flex justify-content-between align-items-center mb-3">
             <h3 class="section-header m-0 border-0 pb-0">‚ñ∂Ô∏è ‡∏Ñ‡∏•‡∏±‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
             <div id="adminVideoBtnGroup" style="display:none; gap: 8px;">
                 <button class="btn btn-primary fw-bold" onclick="openVideoModal()"><i class="material-icons align-middle">add</i> ‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                 <button class="btn btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle">logout</i></button>
             </div>
          </div>
          <div id="videoListContainer" class="row g-4"><div class="text-center text-muted py-5 w-100">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠...</div></div>
        </div>
      </div>

      <div id="page-calendar" style="display:none;">
        <div class="content-section border-0 bg-transparent p-0 mb-4 shadow-none">
          <h2 class="text-primary fw-bold"><i class="material-icons align-middle fs-2">calendar_month</i> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h2>
          <p class="text-muted">‡∏£‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        </div>
        <div class="content-section text-center py-5 shadow-sm border">
           <i class="material-icons text-primary mb-3" style="font-size: 5rem;">event_available</i>
           <h3 class="fw-bold text-dark">‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</h3>
           <p class="text-muted mb-4">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Server ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á</p>
           <a href="http://164.115.44.24/cmbase/public/calendar" target="_blank" class="btn btn-primary btn-lg rounded-pill px-5 py-3 shadow"><i class="material-icons align-middle me-2">open_in_new</i> ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</a>
        </div>
      </div>

      <div id="page-qa" style="display:none;">
        <div class="content-section">
          <div class="d-flex justify-content-between align-items-center mb-3">
             <h3 class="section-header m-0 border-0 pb-0">‚ùì ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A)</h3>
             <div id="adminQABtnGroup" style="display:none; gap: 8px;">
                 <button class="btn btn-primary fw-bold" onclick="openQAModal()"><i class="material-icons align-middle">add</i> ‡πÄ‡∏û‡∏¥‡πà‡∏° Q&A</button>
                 <button class="btn btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle">logout</i></button>
             </div>
          </div>
          <div class="accordion accordion-flush border rounded shadow-sm" id="accQA"></div>
        </div>
      </div>

    </div> 
  </div> 

  <footer class="main-footer container-fluid">
    <div class="row">
      <div class="col-lg-4 mb-4">
        <h5 class="footer-title">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ø</h5>
        <p class="mb-1 text-white-50">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        <p class="small opacity-50">‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏ñ‡∏ô‡∏ô‡πÇ‡∏ä‡∏ï‡∏ô‡∏≤<br>‡∏ï.‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà 50300</p>
        <div class="admin-link-container"><a onclick="loginToggle()" class="admin-trigger text-white-50 text-decoration-none"><i class="material-icons align-middle fs-6 me-1">lock</i> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</a></div>
      </div>
      <div class="col-lg-4 mb-4">
        <h5 class="footer-title">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h5>
        <ul class="list-unstyled text-white-50">
          <li class="mb-2 d-flex"><i class="material-icons me-2 fs-6 mt-1">phone</i> 053-112-703</li>
          <li class="mb-2 d-flex"><i class="material-icons me-2 fs-6 mt-1">email</i> plancm.700@gmail.com</li>
          <li class="d-flex"><i class="material-icons me-2 fs-6 mt-1">schedule</i> ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå (08.30 - 16.30 ‡∏ô.)</li>
        </ul>
      </div>
      <div class="col-lg-4">
        <h5 class="footer-title">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</h5>
        <div class="ratio ratio-16x9 rounded overflow-hidden shadow-sm mb-2" style="background:#333;">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3776.435773177651!2d98.96191761537233!3d18.84534128722079!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x30da3a0026e6d4c1%3A0x6758eb090d5657ff!2z4Lio4Liy4Lil4Liy4LiB4Lil4Liy4LiH4LiI4Lix4LiH4Lir4Lin4Lix4LiU4LmA4LiK4Li14Lii4LiH4LmD4Lir4Lih4LmI!5e0!3m2!1sth!2sth!4v1689655541999!5m2!1sth!2sth" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
      </div>
    </div>
  </footer>

  <div class="modal fade" id="formModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered"><div class="modal-content">
        <div class="modal-header bg-primary text-white"><h5 class="modal-title fw-bold" id="formTitle">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body"><form onsubmit="submitForm(event)">
            <input type="hidden" id="f_topic_type">
            <div class="mb-3"><label class="fw-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="text-danger">*</span></label><input class="form-control" id="f_name" required></div>
            <div class="mb-3"><label class="fw-bold">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label><input class="form-control" id="f_contact"></div>
            <div class="mb-3" id="topicSelectDiv"><label class="fw-bold">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà <span class="text-danger">*</span></label><select class="form-select" id="f_topic_select" required><option value="" selected disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</option><option>‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</option><option>‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à</option><option>‡∏™‡∏±‡∏á‡∏Ñ‡∏°</option><option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option></select></div>
            <div class="mb-3"><label class="fw-bold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î <span class="text-danger">*</span></label><textarea class="form-control" id="f_detail" rows="4" required></textarea></div>
            <button class="btn btn-success w-100 fw-bold">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
        </form></div>
    </div></div>
  </div>

  <div class="modal fade" id="hearingModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-xl modal-dialog-scrollable"><div class="modal-content">
        <div class="modal-header bg-warning text-dark"><h5 class="modal-title fw-bold" id="disp_h_title">‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body bg-light">
          <div class="text-center mb-2"><img id="disp_h_img" class="hearing-banner-img shadow-sm" src="" style="display:none;"></div>
          <div id="hearingClosedMsg" class="alert alert-danger text-center" style="display:none;"><h5>‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß</h5></div>
          <form id="hearingFormContainer" onsubmit="submitHearing(event)" class="bg-white p-4 border rounded shadow-sm">
             <h4 class="fw-bold text-center text-primary mb-4" id="disp_h_plan_name">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤</h4>
             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3" id="disp_h_q1">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h5>
             <div class="row g-3 mb-4"><div class="col-md-6"><input type="text" class="form-control" id="h_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *" required></div><div class="col-md-6"><input type="text" class="form-control" id="h_district" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ *" required></div><div class="col-md-12"><select class="form-select" id="h_sector" required><option value="" selected disabled>-- ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô * --</option><option value="‡∏†‡∏≤‡∏Ñ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô">‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô/‡∏™‡∏±‡∏á‡∏Ñ‡∏°</option><option value="‡∏†‡∏≤‡∏Ñ‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô">‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à/‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</option><option value="‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê">‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£/‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à/‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô</option><option value="‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤">‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</option></select></div></div>
             <div class="bg-light border rounded p-3 mb-4"><h6 class="fw-bold text-dark" id="disp_h_info_title">‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á</h6><p class="small text-muted" id="disp_h_info_desc">...</p><div class="d-flex gap-2"><a id="disp_h_sum" href="#" target="_blank" class="btn btn-outline-primary btn-sm" style="display:none;">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡πà‡∏≠</a><a id="disp_h_full" href="#" target="_blank" class="btn btn-primary btn-sm" style="display:none;">‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°</a></div><div class="form-check mt-3 border-top pt-2"><input class="form-check-input" type="checkbox" id="h_info_consent" required><label class="form-check-label small fw-bold text-danger">‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏£‡πà‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡πâ‡∏ß *</label></div></div>
             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3" id="disp_h_q2">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå</h5>
             <div class="mb-4"><div class="form-check mb-1"><input class="form-check-input" type="radio" name="h_vision" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢" required><label>‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</label></div><div class="form-check mb-1"><input class="form-check-input" type="radio" name="h_vision" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"><label>‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</label></div><div class="form-check"><input class="form-check-input" type="radio" name="h_vision" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"><label>‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</label></div><textarea class="form-control mt-2" id="h_vision_fb" rows="2" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞..."></textarea></div>
             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3" id="disp_h_q3">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô</h5>
             <div class="table-responsive mb-2"><table class="table table-bordered text-center small"><thead class="table-light"><tr><th class="text-start">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô</th><th>‡∏°‡∏≤‡∏Å</th><th>‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</th><th>‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à</th><th>‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢</th></tr></thead><tbody>
                <tr><td class="text-start fw-bold" id="disp_h_s3_1">‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à</td><td><input type="radio" name="h_econ" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å" required></td><td><input type="radio" name="h_econ" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td><td><input type="radio" name="h_econ" value="‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à"></td><td><input type="radio" name="h_econ" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td></tr>
                <tr><td class="text-start fw-bold" id="disp_h_s3_2">‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td><td><input type="radio" name="h_soc" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å" required></td><td><input type="radio" name="h_soc" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td><td><input type="radio" name="h_soc" value="‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à"></td><td><input type="radio" name="h_soc" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td></tr>
                <tr><td class="text-start fw-bold" id="disp_h_s3_3">‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</td><td><input type="radio" name="h_env" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å" required></td><td><input type="radio" name="h_env" value="‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td><td><input type="radio" name="h_env" value="‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à"></td><td><input type="radio" name="h_env" value="‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢"></td></tr>
             </tbody></table></div>
             <textarea class="form-control mb-4" id="h_strategy_fb" rows="2" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞..."></textarea>
             <h5 class="fw-bold text-primary border-bottom pb-2 mb-3" id="disp_h_q4">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</h5>
             <div class="mb-3"><select class="form-select" id="h_priority" required><option value="" selected disabled>-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î --</option><option value="‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ">‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</option><option value="‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">‡∏™‡∏±‡∏á‡∏Ñ‡∏°/‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</option><option value="‡∏î‡πâ‡∏≤‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥">‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</option></select></div>
             <div class="mb-3"><textarea class="form-control" id="h_feedback" rows="3" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ..."></textarea></div>
             <div class="form-check mb-4 small"><input class="form-check-input" type="checkbox" id="h_pdpa" required><label>‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label></div>
             <button type="submit" class="btn btn-warning w-100 fw-bold">‡∏™‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô</button>
          </form>
        </div>
    </div></div>
  </div>

  <div class="modal fade" id="ratingModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered"><div class="modal-content text-center"><div class="modal-header bg-warning border-0"><h5 class="modal-title fw-bold mx-auto">‚≠ê ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h5></div><div class="modal-body p-4">
        <h5 class="mb-3 text-success fw-bold">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö!</h5><p class="text-muted">‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏∞‡∏ö‡∏ö S-MAP</p>
        <div class="star-rating mb-3 fs-1"><i data-val="1" onclick="setStar(1)">star</i><i data-val="2" onclick="setStar(2)">star</i><i data-val="3" onclick="setStar(3)">star</i><i data-val="4" onclick="setStar(4)">star</i><i data-val="5" onclick="setStar(5)">star</i></div>
        <input type="hidden" id="sys_rating_val" value="0"><textarea class="form-control mb-3" id="sys_feedback" rows="2" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)"></textarea><button type="button" class="btn btn-primary w-100 fw-bold" onclick="submitRating()">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</button>
    </div></div></div>
  </div>

  <div class="modal fade" id="chatModal" tabindex="-1"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header bg-info text-white"><h5 class="modal-title fw-bold">ü§ñ ‡∏ñ‡∏≤‡∏° AI</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body p-0"><div id="chatHistory" class="chat-container"></div><div class="p-3 bg-light"><div class="input-group"><input type="text" id="chatInput" class="form-control" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°..." onkeypress="if(event.key==='Enter') sendChat()"><button class="btn btn-primary" onclick="sendChat()"><i class="material-icons">send</i></button></div></div></div></div></div></div>

  <div class="modal fade" id="adminDocModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg"><div class="modal-content">
        <div class="modal-header bg-dark text-white"><h5 class="modal-title fw-bold" id="docModalTitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body bg-light"><form onsubmit="submitDocument(event)">
             <input type="hidden" id="doc_id">
             <div class="row g-2 mb-2">
                 <div class="col-md-9"><label class="small fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ <span class="text-danger">*</span></label><input type="text" class="form-control" id="doc_title" required></div>
                 <div class="col-md-3"><label class="small fw-bold">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label><input type="text" class="form-control" id="doc_year" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567"></div>
             </div>
             <div class="mb-2"><label class="small fw-bold">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label><input type="text" class="form-control" id="doc_desc"></div>
             <div class="row g-2 mb-2">
                <div class="col-md-6"><label class="small fw-bold">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label><select class="form-select" id="doc_cat"><option value="General">‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option><option value="Plan">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤</option><option value="Report">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•</option><option value="Announcement">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</option></select></div>
                <div class="col-md-6"><label class="small fw-bold">AI Chatbot</label><select class="form-select" id="doc_ai_status"><option value="ON">üü¢ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ AI</option><option value="OFF">üî¥ ‡∏õ‡∏¥‡∏î</option></select></div>
             </div>
             <div class="mb-3"><label class="small fw-bold">‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå <span class="text-danger">*</span></label><input type="text" class="form-control" id="doc_link" required></div>
             <div class="p-3 border rounded bg-white"><div class="row">
                 <div class="col-md-4"><label class="small fw-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö</label><input type="number" class="form-control" id="doc_order"></div>
                 <div class="col-md-4 pt-4"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="doc_is_pinned"><label class="small fw-bold">üìå ‡∏õ‡∏±‡∏Å‡∏´‡∏°‡∏∏‡∏î</label></div></div>
                 <div class="col-md-4 pt-4"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="doc_is_important"><label class="small fw-bold text-danger">‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label></div></div>
             </div></div>
             <div class="mt-4 text-end"><button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" class="btn btn-success fw-bold px-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>
        </form></div>
    </div></div>
  </div>

  <div class="modal fade" id="adminVideoModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header bg-dark text-white"><h5 class="modal-title fw-bold" id="vidModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body"><form onsubmit="submitVideo(event)">
             <input type="hidden" id="vid_id">
             <div class="mb-2"><label class="small fw-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</label><input type="text" class="form-control" id="vid_title" required></div>
             <div class="mb-2"><label class="small fw-bold">‡∏•‡∏¥‡∏á‡∏Å‡πå YouTube</label><input type="text" class="form-control" id="vid_link" required></div>
             <div class="mb-3"><label class="small fw-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö</label><input type="number" class="form-control" id="vid_order"></div>
             <div class="text-end"><button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" class="btn btn-success fw-bold px-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>
        </form></div>
    </div></div>
  </div>

  <div class="modal fade" id="adminQAModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header bg-dark text-white"><h5 class="modal-title fw-bold" id="qaModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏° Q&A</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body"><form onsubmit="submitQA(event)">
             <input type="hidden" id="qa_id">
             <div class="row g-2 mb-2"><div class="col-3"><label class="small fw-bold">‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô</label><select class="form-select" id="qa_emoji"><option value="‚ùì">‚ùì</option><option value="üì¢">üì¢</option><option value="üî¥">üî¥</option><option value="üí°">üí°</option></select></div><div class="col-9"><label class="small fw-bold">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</label><input type="text" class="form-control" id="qa_question" required></div></div>
             <div class="mb-3"><label class="small fw-bold">‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</label><textarea class="form-control" id="qa_answer" rows="4" required></textarea></div>
             <div class="text-end"><button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" class="btn btn-success fw-bold px-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>
        </form></div>
    </div></div>
  </div>

  <script>
    // ==========================================
    // üü¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Javascript) ‡∏â‡∏ö‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏ö‡∏±‡∏Ñ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå üü¢
    // ==========================================
    let docs = [], qaList = [], filteredDocs = [], videoList = [];
    let isAdmin = false; let adminToken = "";
    let form1Open = true; let form1Title = "", form1Desc = "", form1Date = "";
    let hOpen = true; let hTitle = "", hDesc = "", hDate = "", hPlanName = "", hRatingOpen = true;
    let charts = { issues: null, sector: null, vision: null, priority: null, econ: null, social: null, env: null };
    let currentPage = 1; const itemsPerPage = 10; let currentDocLink = "";

    function initSystem() { 
      document.getElementById('globalLoader').style.display = 'flex';
      Promise.all([
          fetch(SCRIPT_URL + '?action=getSettings').then(r=>r.json()), 
          fetch(SCRIPT_URL + '?action=getDocs').then(r=>r.json()), 
          fetch(SCRIPT_URL + '?action=getQA').then(r=>r.json()), 
          fetch(SCRIPT_URL + '?action=getVideos').then(r=>r.json())
      ]).then(([settings, docsData, qaData, vidData]) => {
         
         form1Open = (settings.form1_status === 'OPEN'); form1Title = settings.form1_title; form1Desc = settings.form1_desc; form1Date = settings.form1_date;
         hOpen = (settings.h_status === 'OPEN'); hTitle = settings.h_title; hDesc = settings.h_desc; hDate = settings.h_date; hPlanName = settings.h_plan_name; hRatingOpen = (settings.h_rating === 'ON');

         document.getElementById('disp_title_1').innerText = form1Title; document.getElementById('disp_desc_1').innerText = form1Desc; document.getElementById('disp_date_1').innerText = "üìÖ " + form1Date;
         document.getElementById('admin_title_1').value = form1Title; document.getElementById('admin_subtitle_1').value = form1Desc; document.getElementById('admin_date_1').value = form1Date; document.getElementById('swForm1').checked = form1Open;
         if(form1Open) { document.getElementById('banner1').classList.remove('closed'); document.getElementById('statusBadge1').style.display = 'none'; } else { document.getElementById('banner1').classList.add('closed'); document.getElementById('statusBadge1').style.display = 'inline-block'; }

         document.getElementById('disp_h_title').innerText = hTitle; document.getElementById('disp_h_plan_name').innerText = hPlanName; 
         document.getElementById('disp_title_2').innerText = hTitle; document.getElementById('disp_desc_2').innerText = hDesc; document.getElementById('disp_date_2').innerText = "üìÖ " + hDate;
         document.getElementById('h_admin_title').value = hTitle; document.getElementById('h_admin_desc').value = hDesc; document.getElementById('h_admin_date').value = hDate; document.getElementById('h_admin_plan_name').value = hPlanName; 
         document.getElementById('swHearingStatus').checked = hOpen; document.getElementById('swHearingRating').checked = hRatingOpen;
         if(hOpen) { document.getElementById('banner2').classList.remove('closed'); document.getElementById('statusBadge2').style.display = 'none'; document.getElementById('hearingClosedMsg').style.display = 'none'; document.getElementById('hearingFormContainer').style.display = 'block'; } else { document.getElementById('banner2').classList.add('closed'); document.getElementById('statusBadge2').style.display = 'inline-block'; document.getElementById('hearingClosedMsg').style.display = 'block'; document.getElementById('hearingFormContainer').style.display = 'none'; }

         document.getElementById('disp_h_info_title').innerText = settings.h_info_title; document.getElementById('disp_h_info_desc').innerText = settings.h_info_desc;
         document.getElementById('disp_h_q1').innerText = settings.h_q1; document.getElementById('disp_h_q2').innerText = settings.h_q2; document.getElementById('disp_h_q3').innerText = settings.h_q3; document.getElementById('disp_h_q4').innerText = settings.h_q4;
         document.getElementById('disp_h_s3_1').innerText = settings.h_s3_1; document.getElementById('disp_h_s3_2').innerText = settings.h_s3_2; document.getElementById('disp_h_s3_3').innerText = settings.h_s3_3;

         let hImgObj = document.getElementById('disp_h_img'); if(settings.h_img) { hImgObj.src = settings.h_img; hImgObj.style.display = 'block'; } else { hImgObj.style.display = 'none'; }
         let hSumObj = document.getElementById('disp_h_sum'); if(settings.h_sum) { hSumObj.href = settings.h_sum; hSumObj.style.display = 'inline-block'; } else { hSumObj.style.display = 'none'; }
         let hFullObj = document.getElementById('disp_h_full'); if(settings.h_full) { hFullObj.href = settings.h_full; hFullObj.style.display = 'inline-block'; } else { hFullObj.style.display = 'none'; }

         document.getElementById('h_admin_info_title').value = settings.h_info_title; document.getElementById('h_admin_info_desc').value = settings.h_info_desc; document.getElementById('h_admin_img').value = settings.h_img; document.getElementById('h_admin_sum').value = settings.h_sum; document.getElementById('h_admin_full').value = settings.h_full;
         document.getElementById('h_admin_q1').value = settings.h_q1; document.getElementById('h_admin_q2').value = settings.h_q2; document.getElementById('h_admin_q3').value = settings.h_q3; document.getElementById('h_admin_q4').value = settings.h_q4; document.getElementById('h_admin_s3_1').value = settings.h_s3_1; document.getElementById('h_admin_s3_2').value = settings.h_s3_2; document.getElementById('h_admin_s3_3').value = settings.h_s3_3;

         document.getElementById('disp_video_title').innerText = settings.video_title; document.getElementById('admin_video_title').value = settings.video_title;
         updateVideo(settings.video_url); updateDashboard(settings.dash_url);
         
         docs = docsData; qaList = qaData; videoList = vidData;
         buildYearFilter(); filterDocs(); renderQA(); renderVideos();
         
         document.getElementById('globalLoader').style.opacity = '0';
         setTimeout(() => document.getElementById('globalLoader').style.display = 'none', 300);
      }).catch(e => {
          console.error(e);
          Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SCRIPT_URL', 'error');
          document.getElementById('globalLoader').style.display = 'none';
      });
    }

    // üü¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ (‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏ö‡∏±‡∏Ñ‡∏Ñ‡πâ‡∏≤‡∏á)
    function postData(data, callback) { 
       fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(data) })
       .then(r => r.text())
       .then(text => { 
           try { callback(JSON.parse(text)); } 
           catch(e) { Swal.fire('Error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£ Deploy', 'error'); } 
       })
       .catch(e => Swal.fire('Error', '‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï', 'error')); 
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    function getVal(id) { return document.getElementById(id).value; }
    function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); document.getElementById('sidebarOverlay').classList.toggle('active'); }
    function showPage(id) {
      ['home','docs','calendar','qa', 'videos', 'admin-dash'].forEach(p => document.getElementById('page-'+p).style.display = 'none');
      document.getElementById('page-'+id).style.display = 'block';
      document.querySelectorAll('.nav-link-main').forEach(el => el.classList.remove('active'));
      if(id !== 'admin-dash') document.getElementById('menu-'+id).classList.add('active');
      if(id === 'docs') filterDocs(); if(id === 'admin-dash') loadDashboard();
      window.scrollTo(0,0);
      if(window.innerWidth <= 992) { document.getElementById('sidebar').classList.remove('active'); document.getElementById('sidebarOverlay').classList.remove('active'); }
    }
    function scrollToId(id) { showPage('home'); setTimeout(() => document.getElementById(id).scrollIntoView({behavior:'smooth'}), 200); }
    function updateVideo(url) { let id = url ? (url.split('v=')[1] || url.split('/').pop()) : ""; document.getElementById('main_video_frame').src = "https://www.youtube.com/embed/" + id; document.getElementById('admin_video_url').value = url || ""; }
    function updateDashboard(url) { let ph = document.getElementById('dash_placeholder'), fr = document.getElementById('main_dash_frame'); document.getElementById('admin_dash_url').value = url || ""; if (url && url.length > 5) { ph.style.display = 'none'; fr.style.display = 'block'; fr.src = url; } else { ph.style.display = 'flex'; fr.style.display = 'none'; } }
    function formatDate(isoStr) { if(!isoStr) return ""; let d = new Date(isoStr); return d.toLocaleDateString('th-TH') + ' ' + d.toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'}); }

    // ================= ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Docs) =================
    // üü¢ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î Pop-up ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏ö‡∏±‡∏Ñ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
    function openDocModal() { 
        document.getElementById('adminDocForm').reset(); document.getElementById('doc_id').value = ''; 
        document.getElementById('docModalTitle').innerText = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
        bootstrap.Modal.getOrCreateInstance(document.getElementById('adminDocModal')).show(); 
    }
    
    function editDoc(id) {
       let d = docs.find(x => x.id === id); if(!d) return;
       document.getElementById('doc_id').value = d.id; document.getElementById('doc_title').value = d.title;
       document.getElementById('doc_year').value = d.year || ''; document.getElementById('doc_desc').value = d.desc;
       document.getElementById('doc_link').value = d.link; document.getElementById('doc_cat').value = d.type;
       document.getElementById('doc_ai_status').value = d.ai_status || 'ON'; document.getElementById('doc_order').value = d.order == 999 ? '' : d.order;
       document.getElementById('doc_is_pinned').checked = d.is_pinned; document.getElementById('doc_is_important').checked = d.is_important;
       document.getElementById('docModalTitle').innerText = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£';
       bootstrap.Modal.getOrCreateInstance(document.getElementById('adminDocModal')).show();
    }

    function submitDocument(e) {
      e.preventDefault();
      Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
      let payload = { action: 'saveDoc', token: adminToken, id: getVal('doc_id'), title: getVal('doc_title'), desc: getVal('doc_desc'), link: getVal('doc_link'), type: getVal('doc_cat'), ai_status: getVal('doc_ai_status'), year: getVal('doc_year'), order: getVal('doc_order'), is_pinned: document.getElementById('doc_is_pinned').checked, is_important: document.getElementById('doc_is_important').checked };
      postData(payload, (res) => {
          if(res.status==='SUCCESS') { bootstrap.Modal.getOrCreateInstance(document.getElementById('adminDocModal')).hide(); Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß', 'success').then(()=>initSystem()); }
          else Swal.fire('Error', res.message, 'error');
      });
    }

    function deleteDoc(id) { 
        Swal.fire({ title: '‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£?', icon: 'warning', showCancelButton: true, confirmButtonText: '‡πÉ‡∏ä‡πà', cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' }).then((r) => { 
            if (r.isConfirmed) { Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); postData({ action: 'deleteDoc', token: adminToken, id: id }, (res) => { if(res.status==='SUCCESS') { Swal.fire('‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(()=>initSystem()); } else Swal.fire('Error', res.message, 'error'); }); } 
        }); 
    }

    // üü¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏õ‡∏µ (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô String ‡∏Å‡∏±‡∏ô‡∏ö‡∏±‡∏Ñ‡∏´‡∏°‡∏∏‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á)
    function buildYearFilter() {
       let years = new Set();
       docs.forEach(d => { 
           if(d.year !== undefined && d.year !== null && d.year !== "") { 
               let yearStr = d.year.toString().trim(); let parts = yearStr.split('-'); 
               if(parts.length === 2 && !isNaN(parts[0]) && !isNaN(parts[1])) { for(let y = parseInt(parts[0]); y <= parseInt(parts[1]); y++) years.add(y.toString()); } 
               else { years.add(yearStr); } 
           }
       });
       let html = '<option value="All">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>';
       Array.from(years).sort((a,b)=>b-a).forEach(y => html += `<option value="${y}">‡∏õ‡∏µ ${y}</option>`);
       document.getElementById('filterYear').innerHTML = html;
    }

    function sortDocsLogic(a, b) {
       if (a.is_pinned !== b.is_pinned) return a.is_pinned ? -1 : 1; 
       let getYearMax = (y) => { if(!y) return 0; let p = y.toString().split('-'); return p.length === 2 ? parseInt(p[1]) : parseInt(y); };
       let yA = getYearMax(a.year), yB = getYearMax(b.year);
       if (yA !== yB) return yB - yA;
       let oA = a.order || 999, oB = b.order || 999;
       if (oA !== oB) return oA - oB;
       return new Date(b.created) - new Date(a.created);
    }

    function filterDocs() {
       let txt = getVal('searchDoc').toLowerCase(), cat = getVal('filterCat'), yr = getVal('filterYear');
       filteredDocs = docs.filter(d => {
          let mTxt = d.title.toLowerCase().includes(txt) || (d.desc && d.desc.toLowerCase().includes(txt));
          let mCat = (cat === 'All') || (d.type === cat); 
          let mYr = (yr === 'All');
          if(!mYr && d.year) { let docYr = d.year.toString().trim(), p = docYr.split('-'); if(p.length===2) { mYr = (parseInt(yr) >= parseInt(p[0]) && parseInt(yr) <= parseInt(p[1])); } else { mYr = (yr === docYr); } }
          return mTxt && mCat && mYr;
       });
       filteredDocs.sort(sortDocsLogic); currentPage = 1; renderDocs();
    }
    function clearSearch() { document.getElementById('searchDoc').value=''; document.getElementById('filterCat').value='All'; document.getElementById('filterYear').value='All'; filterDocs(); }

    function getCatBadge(type) { 
        let l = type, c = 'bg-secondary'; 
        switch(type){ case 'General': l='‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ'; break; case 'Plan': l='‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤'; c='bg-primary'; break; case 'Report': l='‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•'; c='bg-success'; break; case 'Announcement': l='‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á'; c='bg-warning text-dark'; break; } 
        return `<span class="badge ${c}">${l}</span>`; 
    }

    // üü¢ ‡∏£‡∏∞‡∏ö‡∏ö Render ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏Ñ‡∏π‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≤‡∏¢ NEW ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà)
    function renderDocs() {
      let html = ''; 
      if(filteredDocs.length === 0) { html = '<div class="text-center text-muted py-5">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>'; document.getElementById('pagination').innerHTML=''; } 
      else {
        let start = (currentPage - 1) * itemsPerPage, end = start + itemsPerPage, paginatedItems = filteredDocs.slice(start, end);
        paginatedItems.forEach(doc => {
          let icon = 'description', color = 'text-primary'; if(doc.link.includes('drive')) { icon = 'add_to_drive'; color = 'text-success'; } else if(doc.link.includes('.pdf')) { icon = 'picture_as_pdf'; color = 'text-danger'; }
          let dateStr = "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: " + formatDate(doc.created); 
          
          let badges = '';
          if(doc.is_pinned) badges += `<span class="badge badge-pin me-1">üìå ‡∏õ‡∏±‡∏Å‡∏´‡∏°‡∏∏‡∏î</span>`;
          if(doc.is_important) badges += `<span class="badge bg-danger me-1">‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</span>`;
          
          // üåü ‡∏õ‡πâ‡∏≤‡∏¢ NEW ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏™‡∏µ‡∏ó‡∏≠‡∏á ‡∏Ç‡∏≠‡∏ö‡πÅ‡∏î‡∏á‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö
          let ageDays = (new Date() - new Date(doc.created)) / (1000 * 60 * 60 * 24);
          if(ageDays < 14) badges += `<span class="badge-custom-new me-2">NEW</span>`;

          // üóìÔ∏è ‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
          let catBadge = getCatBadge(doc.type);
          let yrBadge = doc.year ? `<span class="badge bg-info text-dark ms-1"><i class="material-icons align-middle" style="font-size: 11px;">event</i> ‡∏õ‡∏µ ${doc.year}</span>` : '';

          let editBtn = isAdmin ? `<button class="btn btn-sm btn-outline-warning ms-2" onclick="editDoc('${doc.id}')">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>` : ''; 
          let deleteBtn = isAdmin ? `<button class="btn btn-sm btn-outline-danger ms-2" onclick="deleteDoc('${doc.id}')">‡∏•‡∏ö</button>` : '';
          let chatBtn = doc.ai_status === 'OFF' ? `<button class="btn btn-sm btn-secondary text-white me-2 opacity-50" style="cursor:not-allowed;"><i class="material-icons align-middle" style="font-size:16px;">smart_toy</i> ‡∏õ‡∏¥‡∏î AI</button>` : `<button class="btn btn-sm btn-info text-white me-2" onclick="openChat('${doc.id}')"><i class="material-icons align-middle" style="font-size:16px;">smart_toy</i> ‡∏ñ‡∏≤‡∏° AI</button>`;
          
          html += `<div class="list-group-item list-group-item-action d-flex align-items-start py-4 px-3 border-bottom"><i class="material-icons fs-2 me-4 mt-1 ${color}">${icon}</i><div class="flex-grow-1"><a href="${doc.link}" target="_blank" class="text-decoration-none text-dark"><div class="mb-1 d-flex align-items-center flex-wrap">${badges}</div><h5 class="mb-2 fw-bold">${doc.title}</h5><div class="mb-2 d-flex flex-wrap align-items-center">${catBadge}${yrBadge} <span class="text-muted small ms-2 d-block d-md-inline mt-1 mt-md-0">${doc.desc || ""}</span></div><small class="text-secondary">${dateStr}</small></a></div><div class="d-flex align-items-center">${chatBtn} ${editBtn} ${deleteBtn}</div></div>`;
        });
        renderPagination();
      } 
      document.getElementById('docListContainer').innerHTML = html;
    }
    function renderPagination() { let tP = Math.ceil(filteredDocs.length / itemsPerPage); let h = ''; if(tP > 1) { h += `<div class="page-btn ${currentPage===1 ? 'disabled' : ''}" onclick="changePage(${currentPage-1})">¬´</div>`; for(let i=1; i<=tP; i++) { if(i===1 || i===tP || (i>=currentPage-1 && i<=currentPage+1)) { h += `<div class="page-btn ${i===currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</div>`; } else if(i===currentPage-2 || i===currentPage+2) { h += `<span class="px-2">...</span>`; } } h += `<div class="page-btn ${currentPage===tP ? 'disabled' : ''}" onclick="changePage(${currentPage+1})">¬ª</div>`; } document.getElementById('pagination').innerHTML = h; }
    function changePage(p) { let tP = Math.ceil(filteredDocs.length / itemsPerPage); if(p < 1 || p > tP) return; currentPage = p; renderDocs(); }

    // ================= Chat AI =================
    function openChat(docId) { let doc = docs.find(d => d.id === docId); if(!doc) return; currentDocLink = doc.link; document.getElementById('chatHistory').innerHTML = `<div class="chat-ai chat-msg">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö <strong>"${doc.title}"</strong> ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üòä<br><br><small class="text-danger">‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ</small></div>`; bootstrap.Modal.getOrCreateInstance(document.getElementById('chatModal')).show(); }
    function sendChat() { let input = document.getElementById('chatInput'); let question = input.value.trim(); if(!question) return; let history = document.getElementById('chatHistory'); history.innerHTML += `<div class="chat-user chat-msg">${question}</div>`; input.value = ''; history.scrollTop = history.scrollHeight; let loadingId = 'loading_' + Date.now(); history.innerHTML += `<div id="${loadingId}" class="chat-ai chat-msg typing-indicator"><span></span><span></span><span></span></div>`; history.scrollTop = history.scrollHeight; postData({ action: 'chatWithAI', link: currentDocLink, question: question }, (data) => { document.getElementById(loadingId).remove(); let answer = data.status === 'SUCCESS' ? data.answer : "‚ùå " + data.answer; answer = answer.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>'); history.innerHTML += `<div class="chat-ai chat-msg">${answer}</div>`; history.scrollTop = history.scrollHeight; }); }

    // ================= ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (Videos) =================
    function openVideoModal() { document.getElementById('vid_id').value=''; document.getElementById('vid_title').value=''; document.getElementById('vid_link').value=''; document.getElementById('vid_order').value=''; document.getElementById('vidModalTitle').innerText='‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠'; bootstrap.Modal.getOrCreateInstance(document.getElementById('adminVideoModal')).show(); }
    function editVideo(id) { let v = videoList.find(x => x.id === id); if(!v) return; document.getElementById('vid_id').value = v.id; document.getElementById('vid_title').value = v.title; document.getElementById('vid_link').value = v.link; document.getElementById('vid_order').value = v.order == 999 ? "" : v.order; document.getElementById('vidModalTitle').innerText='‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠'; bootstrap.Modal.getOrCreateInstance(document.getElementById('adminVideoModal')).show(); }
    function submitVideo(e) { e.preventDefault(); Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); postData({ action: 'saveVideo', token: adminToken, id: getVal('vid_id'), title: getVal('vid_title'), link: getVal('vid_link'), order: getVal('vid_order') }, (res) => { if (res.status === 'SUCCESS') { bootstrap.Modal.getOrCreateInstance(document.getElementById('adminVideoModal')).hide(); Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏•‡πâ‡∏ß', '', 'success').then(()=>initSystem()); } else { Swal.fire('Error', res.message, 'error'); } }); }
    function deleteVideo(id) { Swal.fire({ title: '‡∏•‡∏ö‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠?', icon: 'warning', showCancelButton: true }).then((r) => { if (r.isConfirmed) { Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...', didOpen: () => Swal.showLoading() }); postData({ action: 'deleteVideo', token: adminToken, id: id }, (res) => { if(res.status==='SUCCESS'){ Swal.fire('‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(()=>initSystem());} else { Swal.fire('Error', res.message, 'error'); } }); } }); }
    function renderVideos() { let h = ''; if(videoList.length === 0) { h = '<div class="text-center text-muted py-5 w-100">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</div>'; } else { videoList.forEach(vid => { let vId = extractYouTubeID(vid.link); let embedUrl = vId ? "https://www.youtube.com/embed/" + vId : ""; let adm = isAdmin ? `<div class="p-2 bg-light border-top d-flex justify-content-between"><small class="fw-bold text-muted">‡∏•‡∏≥‡∏î‡∏±‡∏ö: ${vid.order==999?'':vid.order}</small><div><button class="btn btn-sm btn-outline-warning me-1" onclick="editVideo('${vid.id}')">‡πÅ‡∏Å‡πâ</button><button class="btn btn-sm btn-outline-danger" onclick="deleteVideo('${vid.id}')">‡∏•‡∏ö</button></div></div>` : ''; h += `<div class="col-md-6 col-lg-4"><div class="video-card"><div class="video-title-bar"><div class="video-title-text">${vid.title}</div></div><div class="ratio ratio-16x9"><iframe src="${embedUrl}" allowfullscreen></iframe></div>${adm}</div></div>`; }); } document.getElementById('videoListContainer').innerHTML = h; }

    // ================= ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (QA) =================
    function openQAModal() { document.getElementById('qa_id').value=''; document.getElementById('qa_emoji').value='‚ùì'; document.getElementById('qa_question').value=''; document.getElementById('qa_answer').value=''; document.getElementById('qaModalTitle').innerText='‡πÄ‡∏û‡∏¥‡πà‡∏° Q&A'; bootstrap.Modal.getOrCreateInstance(document.getElementById('adminQAModal')).show(); }
    function editQA(id) { let q = qaList.find(x => x.id === id); if(!q) return; document.getElementById('qa_id').value = q.id; document.getElementById('qa_emoji').value = q.emoji||'‚ùì'; document.getElementById('qa_question').value = q.q; document.getElementById('qa_answer').value = q.a; document.getElementById('qaModalTitle').innerText='‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Q&A'; bootstrap.Modal.getOrCreateInstance(document.getElementById('adminQAModal')).show(); }
    function submitQA(e) { e.preventDefault(); Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); postData({ action: 'saveQA', token: adminToken, id: getVal('qa_id'), q: getVal('qa_question'), a: getVal('qa_answer'), emoji: getVal('qa_emoji') }, (res) => { if(res.status==='SUCCESS'){ bootstrap.Modal.getOrCreateInstance(document.getElementById('adminQAModal')).hide(); Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(()=>initSystem()); } else Swal.fire('Error', res.message, 'error'); }); }
    function deleteQA(id) { Swal.fire({ title: '‡∏•‡∏ö‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö?', icon: 'warning', showCancelButton: true }).then((r) => { if (r.isConfirmed) { Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...', didOpen: () => Swal.showLoading() }); postData({ action: 'deleteQA', token: adminToken, id: id }, (res) => { if(res.status==='SUCCESS'){ Swal.fire('‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(()=>initSystem());} else Swal.fire('Error', res.message, 'error'); }); } }); }
    function renderQA() { let h = ''; if(qaList.length === 0) { h = '<div class="text-center text-muted py-5">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>'; } else { qaList.forEach((item, index) => { let adm = isAdmin ? `<div class="mt-2 text-end border-top pt-2"><button class="btn btn-sm btn-outline-warning ms-2" onclick="editQA('${item.id}')">‡πÅ‡∏Å‡πâ</button> <button class="btn btn-sm btn-outline-danger ms-2" onclick="deleteQA('${item.id}')">‡∏•‡∏ö</button></div>` : ''; h += `<div class="accordion-item border rounded mb-3 shadow-sm"><h2 class="accordion-header"><button class="accordion-button collapsed fw-bold text-start" type="button" data-bs-toggle="collapse" data-bs-target="#qa${index}"><span class="me-2 fs-5">${item.emoji}</span> ${item.q}</button></h2><div id="qa${index}" class="accordion-collapse collapse" data-bs-parent="#accQA"><div class="accordion-body bg-light">${item.a.replace(/\n/g,'<br>')}${adm}</div></div></div>`; }); } document.getElementById('accQA').innerHTML = h; }

    // ================= ‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ =================
    function saveGeneralConfig() { let vt = getVal('admin_video_title'); if (!vt) return Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠', 'warning'); Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', didOpen: () => Swal.showLoading() }); postData({ action: 'updateGeneralConfig', token: adminToken, vTitle: vt, video: getVal('admin_video_url'), dash: getVal('admin_dash_url') }, (res) => { if(res.status === 'SUCCESS') { Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(()=>initSystem()); } else Swal.fire('Error', res.message, 'error'); }); }
    function saveFormConfig() { Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', didOpen: () => Swal.showLoading() }); postData({ action: 'updateFormConfig', token: adminToken, key: 'FORM_1', title: getVal('admin_title_1'), subtitle: getVal('admin_subtitle_1'), dateText: getVal('admin_date_1'), status: document.getElementById('swForm1').checked ? 'OPEN' : 'CLOSED' }, (res) => { if(res.status === 'SUCCESS') Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(()=>initSystem()); else Swal.fire('Error', res.message, 'error'); }); }
    function saveHearingConfig() { Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', didOpen: () => Swal.showLoading() }); postData({ action: 'updateHearingConfig', token: adminToken, h_title: getVal('h_admin_title'), h_desc: getVal('h_admin_desc'), h_date: getVal('h_admin_date'), h_plan_name: getVal('h_admin_plan_name'), h_status: document.getElementById('swHearingStatus').checked ? 'OPEN' : 'CLOSED', h_rating: document.getElementById('swHearingRating').checked ? 'ON' : 'OFF', h_img: getVal('h_admin_img'), h_sum: getVal('h_admin_sum'), h_full: getVal('h_admin_full'), h_info_title: getVal('h_admin_info_title'), h_info_desc: getVal('h_admin_info_desc'), h_q1: getVal('h_admin_q1'), h_q2: getVal('h_admin_q2'), h_q3: getVal('h_admin_q3'), h_q4: getVal('h_admin_q4'), h_s3_1: getVal('h_admin_s3_1'), h_s3_2: getVal('h_admin_s3_2'), h_s3_3: getVal('h_admin_s3_3') }, (res) => { if(res.status === 'SUCCESS') Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '', 'success').then(()=>initSystem()); else Swal.fire('Error', res.message, 'error'); }); }
    
    function handleBannerClick(num) { if(num === 1) { if(form1Open) { document.getElementById('formTitle').innerText = form1Title; document.getElementById('f_topic_type').value = form1Title; document.getElementById('topicSelectDiv').style.display = 'block'; bootstrap.Modal.getOrCreateInstance(document.getElementById('formModal')).show(); } else { Swal.fire('‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß'); } } else if (num === 2) { if(hOpen) { bootstrap.Modal.getOrCreateInstance(document.getElementById('hearingModal')).show(); } else { Swal.fire('‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô'); } } }
    
    function submitForm(e) { e.preventDefault(); let btn = e.target.querySelector('button'); btn.disabled = true; btn.innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...'; let top = getVal('f_topic_select') + " (" + getVal('f_topic_type') + ")"; postData({ action:'saveForm', name: getVal('f_name'), contact: getVal('f_contact'), detail: getVal('f_detail'), topic: top }, (res) => { btn.disabled = false; btn.innerText = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô'; if (res.status === 'SUCCESS') { Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö','success'); e.target.reset(); bootstrap.Modal.getOrCreateInstance(document.getElementById('formModal')).hide(); } else Swal.fire('Error', res.message, 'error'); }); }
    
    function submitHearing(e) { e.preventDefault(); let btn = document.getElementById('btnSubmitHearing'); btn.disabled = true; btn.innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...'; postData({ action: 'saveHearing', plan_name: hPlanName, name: getVal('h_name'), district: getVal('h_district'), sector: getVal('h_sector'), vision: document.querySelector('input[name="h_vision"]:checked')?.value || "", vision_fb: getVal('h_vision_fb'), econ: document.querySelector('input[name="h_econ"]:checked')?.value || "", social: document.querySelector('input[name="h_soc"]:checked')?.value || "", env: document.querySelector('input[name="h_env"]:checked')?.value || "", strategy_fb: getVal('h_strategy_fb'), priority: getVal('h_priority'), feedback: getVal('h_feedback') }, (res) => { btn.disabled = false; btn.innerText = '‡∏™‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô'; if(res.status === 'SUCCESS') { e.target.reset(); bootstrap.Modal.getOrCreateInstance(document.getElementById('hearingModal')).hide(); if(hRatingOpen) { bootstrap.Modal.getOrCreateInstance(document.getElementById('ratingModal')).show(); } else { Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success'); } } else Swal.fire('Error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡πâ', 'error'); }); }
    
    function setStar(val) { document.getElementById('sys_rating_val').value = val; document.querySelectorAll('.star-rating i').forEach((item, idx) => { if(idx < val) item.classList.add('active'); else item.classList.remove('active'); }); }
    function submitRating() { let sc = getVal('sys_rating_val'); if(sc == 0) return Swal.fire('‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö'); Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...', didOpen: () => Swal.showLoading() }); postData({ action: 'saveRating', stars: sc, sysFeedback: getVal('sys_feedback') }, (res) => { bootstrap.Modal.getOrCreateInstance(document.getElementById('ratingModal')).hide(); Swal.fire('‡∏Ç‡∏≠‡∏ö‡∏û‡∏£‡∏∞‡∏Ñ‡∏∏‡∏ì!', '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', 'success'); document.getElementById('sys_rating_val').value = 0; document.getElementById('sys_feedback').value = ''; setStar(0); }); }

    // ================= ‡∏£‡∏∞‡∏ö‡∏ö Admin Login =================
    function loginToggle() {
      if(isAdmin) return logoutSystem();
      Swal.fire({ title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin', html: '<input id="swal-u" class="swal2-input" placeholder="Username"><input id="swal-p" class="swal2-input" placeholder="Password" type="password">', preConfirm: () => [getVal('swal-u'), getVal('swal-p')] }).then((r) => { if (r.isConfirmed) { if (!r.value[0] || !r.value[1]) return Swal.fire('‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö'); Swal.fire({ title: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...', didOpen: () => Swal.showLoading() }); postData({action: 'login', username: r.value[0], password: r.value[1]}, (data) => { if(data.status === 'SUCCESS') { adminToken = r.value[1]; setAdminMode(true); Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '', 'success'); } else Swal.fire('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error'); }); } });
    }
    function logoutSystem() { Swal.fire({ title: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?', showCancelButton: true }).then((r) => { if(r.isConfirmed) { adminToken = ""; setAdminMode(false); Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '', 'success'); } }); }
    function setAdminMode(st) { isAdmin = st; document.getElementById('adminHomePanel').style.display = st ? 'block' : 'none'; ['adminDocBtnGroup', 'adminQABtnGroup', 'adminVideoBtnGroup', 'adminMenuSection'].forEach(id => { let el = document.getElementById(id); if(el) el.style.display = st ? 'flex' : 'none'; }); renderDocs(); renderQA(); renderVideos(); }

    function loadDashboard() {
       Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', didOpen: () => Swal.showLoading() });
       fetch(SCRIPT_URL + '?action=getDashboardStats').then(r => r.json()).then(data => {
           Swal.close(); document.getElementById('btnOpenSheet').href = data.sheetUrl; document.getElementById('stat_issues_total').innerText = data.issues.total; document.getElementById('stat_hearing_total').innerText = data.hearing.total;
           renderChart('chartIssues', 'bar', Object.keys(data.issues.byCat), Object.values(data.issues.byCat), '‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á', '#e91e63'); renderChart('chartSector', 'pie', Object.keys(data.hearing.bySector), Object.values(data.hearing.bySector), '‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô', ['#f1c40f','#e67e22','#e74c3c','#9b59b6', '#34495e']); renderChart('chartVision', 'doughnut', Object.keys(data.hearing.byVision), Object.values(data.hearing.byVision), '‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå', ['#2ecc71','#f1c40f','#e74c3c']); renderChart('chartPriority', 'bar', Object.keys(data.hearing.byPriority), Object.values(data.hearing.byPriority), '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç', '#34495e');
           const stdL = ['‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏≤‡∏Å', '‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢', '‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à', '‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏î‡πâ‡∏ß‡∏¢'], stdC = ['#27ae60', '#2ecc71', '#f1c40f', '#e74c3c']; let getD = (obj) => stdL.map(l => obj[l] || 0);
           renderChart('chartEcon', 'doughnut', stdL, getD(data.hearing.byEcon), '', stdC); renderChart('chartSocial', 'doughnut', stdL, getD(data.hearing.bySocial), '', stdC); renderChart('chartEnv', 'doughnut', stdL, getD(data.hearing.byEnv), '', stdC);
       }).catch(e => Swal.fire('Error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÑ‡∏î‡πâ', 'error'));
    }
  </script>
</body>
</html>
