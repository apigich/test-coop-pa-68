<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <style>
    /* === Global Styles === */
    body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; overflow-x: hidden; }
    
    /* Header */
    .main-header { 
      background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Doi_Suthep_02.jpg/1200px-Doi_Suthep_02.jpg') center center/cover no-repeat; 
      color: white; padding: 60px 0; position: relative; 
    }
    .header-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, rgba(13, 110, 253, 0.95) 0%, rgba(0, 50, 133, 0.85) 100%); z-index: 1; }
    .header-content { position: relative; z-index: 2; padding: 0 40px; display: flex; align-items: center; }
    .org-title-group { display: flex; flex-direction: column; justify-content: center; }
    .org-top-text { font-weight: 400; font-size: 1.2rem; letter-spacing: 1px; color: #ffeb3b; margin-bottom: 5px; text-transform: uppercase; }
    .org-main-text { font-weight: 800; line-height: 1.2; text-shadow: 0 4px 6px rgba(0,0,0,0.3); font-size: clamp(1.5rem, 3vw, 2.2rem); }
    .eng-subtitle { font-weight: 300; opacity: 0.8; font-size: 0.9rem; margin-top: 8px; letter-spacing: 0.5px; }
    @media (max-width: 768px) {
      .main-header { padding: 40px 0; }
      .header-content { flex-direction: column; text-align: center; padding: 0 20px; }
      .header-icon-box { margin-bottom: 15px; margin-right: 0 !important; }
      .org-top-text { font-size: 1rem; }
      .org-main-text { font-size: 1.4rem; }
    }
    
    /* === Layout & Sidebar (Sticky & Toggle) === */
    .wrapper { 
      display: flex; width: 100%; 
      align-items: flex-start; /* üü¢ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Sticky ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á */
    }
    
    .sidebar {
      min-width: 250px; max-width: 250px; 
      background: white; border-right: 1px solid #e9ecef;
      transition: all 0.3s; 
      
      /* üü¢ Sticky Logic: ‡πÄ‡∏°‡∏ô‡∏π‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏à‡∏≠‡πÄ‡∏™‡∏°‡∏≠ */
      position: sticky; 
      top: 0; 
      height: 100vh; /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ */
      overflow-y: auto; /* ‡∏ñ‡πâ‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ */
      z-index: 1000;
      
      display: flex; flex-direction: column;
    }
    
    /* Mobile: ‡∏ã‡πà‡∏≠‡∏ô Sidebar */
    @media (max-width: 768px) {
      .sidebar { 
        margin-left: -250px; 
        position: fixed; /* ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Fixed */
        height: 100%; 
        box-shadow: 2px 0 5px rgba(0,0,0,0.1); 
      }
      .sidebar.active { margin-left: 0; }
      .overlay { display: none; position: fixed; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 998; opacity: 0; transition: all 0.5s ease-in-out; }
      .overlay.active { display: block; opacity: 1; }
    }

    .sidebar-toggle-btn {
      position: absolute; top: 20px; left: 20px; z-index: 1001;
      background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.5); 
      color: white; border-radius: 5px; padding: 5px 10px; cursor: pointer;
    }
    .sidebar-toggle-btn:hover { background: rgba(255,255,255,0.4); }

    .nav-link-main { padding: 15px 20px; color: #0d6efd; font-weight: 700; cursor: pointer; display: block; text-decoration: none; border-bottom: 1px solid #f8f9fa; transition: 0.2s; font-size: 1.05rem; }
    .nav-link-main:hover { background-color: #f1f8ff; color: #0a58ca; padding-left: 25px; }
    .nav-link-main.active { background-color: #e7f1ff; border-left: 5px solid #0d6efd; color: #0d6efd; }
    .nav-link-sub { padding: 10px 20px 10px 45px; color: #6c757d; cursor: pointer; display: block; text-decoration: none; font-size: 0.95rem; transition: 0.2s; position: relative; }
    .nav-link-sub:hover { color: #0d6efd; background-color: #f8f9fa; transform: translateX(5px); }
    .sidebar-logout-btn { background: white; border: 1px solid #6c757d; color: #6c757d; border-radius: 5px; padding: 10px; width: 100%; text-align: center; transition: 0.2s; display: flex; align-items: center; justify-content: center; cursor: pointer; }
    .sidebar-logout-btn:hover { background: #f8f9fa; color: #000; border-color: #000; }

    /* Content */
    .main-content { width: 100%; padding: 20px; min-height: 100vh; background-color: #f0f2f5; }
    .content-section { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); margin-bottom: 25px; border: 1px solid #fff; }
    .section-header { padding-bottom: 10px; margin-bottom: 20px; color: #0d6efd; font-weight: 700; font-size: 1.4rem; border-bottom: 2px solid #f0f0f0; }

    /* Banner Buttons */
    .banner-btn {
      display: flex; align-items: center; justify-content: flex-start;
      padding: 15px 20px; margin-bottom: 20px; border-radius: 15px;
      color: white; cursor: pointer; transition: all 0.3s ease; 
      box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative; overflow: hidden;
      border: none; width: 100%; text-align: left;
      background-size: cover !important; background-position: center !important; background-repeat: no-repeat !important;
    }
    .banner-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); color: white; }
    
    .banner-icon { 
      width: 100px; height: 100px; min-width: 100px; min-height: 100px;
      border-radius: 50%; font-size: 4rem; background: rgba(255,255,255,0.25);
      display: flex; align-items: center; justify-content: center; margin-right: 20px;
      flex-shrink: 0; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .banner-text { text-align: center; flex-grow: 1; position: relative; z-index: 2; }
    .banner-title { font-weight: 800; font-size: 1.6rem; margin-bottom: 5px; line-height: 1.2; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    .banner-desc { font-size: 1.1rem; opacity: 0.95; font-weight: 400; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .banner-btn.closed { filter: grayscale(100%); opacity: 0.7; background: #636e72 !important; cursor: not-allowed; }
    .banner-btn.closed:hover { transform: none; box-shadow: none; }
    .new-badge { position: absolute; top: 0; left: 0; background: #ff0000; color: white; font-size: 0.75rem; font-weight: bold; padding: 5px 15px; border-bottom-right-radius: 10px; box-shadow: 2px 2px 5px rgba(0,0,0,0.2); z-index: 10; display: none; }
    
    .bg-gradient-pink { background: linear-gradient(135deg, #ff7eb3 0%, #ff758c 100%); }
    .bg-gradient-yellow { background: linear-gradient(135deg, #fce38a 0%, #f38181 100%); color: #4a4a4a !important; }
    .has-bg-image.bg-gradient-pink { background: linear-gradient(135deg, rgba(255, 126, 179, 0.85), rgba(255, 117, 140, 0.85)); }
    .has-bg-image.bg-gradient-yellow { background: linear-gradient(135deg, rgba(252, 227, 138, 0.85), rgba(243, 129, 129, 0.85)); }
    .bg-gradient-yellow .banner-desc { color: #d63031; font-weight: bold; }

    /* Carousel */
    .carousel-item img { height: 350px; object-fit: cover; border-radius: 10px; }
    .carousel-caption { display: none !important; }
    .carousel-control-prev-icon, .carousel-control-next-icon { background-color: rgba(0,0,0,0.5); border-radius: 50%; padding: 25px; background-size: 50% 50%; }
    .carousel-control-prev, .carousel-control-next { width: 10%; opacity: 0.8; }
    .carousel-control-prev:hover, .carousel-control-next:hover { opacity: 1; }

    /* Admin & Footer */
    .main-footer { background-color: #1a1d20; color: #cfd2d6; padding: 60px 40px; margin-top: auto; border-top: 5px solid #0d6efd; }
    .footer-title { color: white; font-weight: 700; margin-bottom: 20px; border-left: 4px solid #0d6efd; padding-left: 10px; }
    .admin-trigger { cursor: pointer; opacity: 0.5; transition: 0.3s; margin-top: 20px; display: inline-block; font-size: 0.85rem; }
    .admin-trigger:hover { opacity: 1; color: #fff; }
    .admin-controls { display: none; background: #fff3cd; border: 1px solid #ffeeba; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
  </style>
</head>
<body onload="initSystem()">

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwGWDn2t6cPkNDJyuYN_RXvBfB_m7MM1gdHs4-QVKLhRWOhkDjbxeOQxoAc3ZKoJaZFEg/exec"; 
  </script>

  <header class="main-header container-fluid p-0">
    <div class="header-overlay"></div>
    <div class="header-content">
      <button class="sidebar-toggle-btn d-md-none me-3" onclick="toggleSidebar()"><i class="material-icons">menu</i></button>
      <div class="me-4 header-icon-box d-none d-md-block"><i class="material-icons" style="font-size: 5.5rem;">account_balance</i></div> 
      <div class="org-title-group">
        <div class="org-top-text">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</div>
        <h1 class="m-0 org-main-text">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h1>
        <div class="eng-subtitle">Strategy and Information for Provincial Development</div>
      </div>
    </div>
  </header>

  <div class="wrapper">
    <div class="overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <nav class="sidebar" id="sidebar">
      <div class="flex-grow-1 pt-3">
        <h6 class="px-3 text-secondary fw-bold mt-3 mb-2" style="font-size: 0.85rem; letter-spacing: 1px;">MENU</h6>
        <a class="nav-link-main active" id="menu-home" onclick="showPage('home')">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <div id="sub-home" class="mb-2">
          <a class="nav-link-sub" onclick="scrollToId('sec-feedback')">‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-dash')">Dashboard</a>
          <a class="nav-link-sub" onclick="scrollToId('sec-pr')">‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</a>
        </div>
        <a class="nav-link-main" id="menu-docs" onclick="showPage('docs')">üìÇ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
        <a class="nav-link-main" id="menu-calendar" onclick="showPage('calendar')">üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</a>
        <a class="nav-link-main" id="menu-qa" onclick="showPage('qa')">‚ùì ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A)</a>
      </div>
      <div id="sidebarLogoutArea" class="px-3 mb-4 mt-auto" style="display:none;">
         <button class="sidebar-logout-btn" onclick="logoutSystem()">
           <i class="material-icons align-middle fs-6 me-2">logout</i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
         </button>
      </div>
    </nav>

    <div class="main-content">
      
      <div id="page-home">
        <div id="section-video" class="content-section text-center">
          <h3 class="section-header">üì∫ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
          <div class="ratio ratio-16x9 w-100 w-md-75 mx-auto shadow rounded overflow-hidden" style="max-width: 800px;">
            <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" allowfullscreen></iframe>
          </div>
        </div>

        <div id="adminHomePanel" class="content-section bg-warning-subtle border-warning" style="display:none;">
          <div class="d-flex justify-content-between align-items-center mb-3">
             <h5 class="fw-bold text-dark m-0"><i class="material-icons align-middle">admin_panel_settings</i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ü‡∏≠‡∏£‡πå‡∏°</h5>
             <button class="btn btn-sm btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle fs-6">logout</i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
          </div>
          <hr class="border-secondary opacity-25">
          <div class="row">
            <div class="col-md-6 mb-3">
               <div class="bg-white p-3 rounded shadow-sm h-100">
                  <div class="form-check form-switch d-flex justify-content-between align-items-center">
                    <div><label class="form-check-label fw-bold" for="swForm1">üî¥ ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</label><div class="small text-muted">‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div></div>
                    <input class="form-check-input fs-4" type="checkbox" id="swForm1" onchange="toggleForm(1)">
                  </div>
               </div>
            </div>
            <div class="col-md-6 mb-3">
               <div class="bg-white p-3 rounded shadow-sm h-100">
                  <div class="form-check form-switch d-flex justify-content-between align-items-center">
                    <div><label class="form-check-label fw-bold" for="swForm2">üü° ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏û‡∏¥‡πÄ‡∏®‡∏©</label><div class="small text-muted">‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©</div></div>
                    <input class="form-check-input fs-4" type="checkbox" id="swForm2" onchange="toggleForm(2)">
                  </div>
               </div>
            </div>
          </div>
        </div>

        <div id="sec-feedback" class="content-section text-center" style="background: #fff;">
          <h3 class="fw-bold mb-5 text-dark" style="letter-spacing: 1px;">üì¢ ‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h3>
          <div class="row justify-content-center">
            <div class="col-lg-9 mb-4 position-relative">
              <div id="banner1" class="banner-btn bg-gradient-pink" onclick="handleBannerClick(1)" role="button">
                <div id="badge1" class="new-badge">NEW</div>
                <div class="banner-icon"><i class="material-icons">assignment</i></div>
                <div class="banner-text">
                   <div class="banner-title">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</div>
                   <div class="banner-desc">(‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ï‡∏•‡∏≠‡∏î 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</div>
                   <div id="statusText1" class="banner-desc mt-2 badge bg-white text-danger fs-6">üìÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö: 1 ‡∏°.‡∏Ñ. 68 - 31 ‡∏ò.‡∏Ñ. 68</div>
                </div>
              </div>
            </div>
            <div class="col-lg-9 mb-3 position-relative">
              <div id="banner2" class="banner-btn bg-gradient-yellow" onclick="handleBannerClick(2)" role="button">
                <div id="badge2" class="new-badge">NEW</div>
                <div class="banner-icon"><i class="material-icons">groups</i></div>
                <div class="banner-text">
                   <div class="banner-title">‡πÄ‡∏™‡∏ô‡∏≠‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢: ‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà 2030</div>
                   <div class="banner-desc">(‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©/‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Ñ‡∏°)</div>
                   <div id="statusText2" class="banner-desc mt-2 badge bg-danger text-white fs-6">üìÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö: 1 ‡∏Å.‡∏û. 68 - 28 ‡∏Å.‡∏û. 68</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="sec-dash" class="content-section text-center">
          <h4 class="text-primary mb-4 fw-bold">üìä Dashboard ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
          <div class="ratio ratio-16x9 w-100 border rounded shadow-sm bg-white overflow-hidden">
             <div class="d-flex flex-column align-items-center justify-content-center h-100 bg-light text-muted">
                <i class="material-icons" style="font-size: 4rem;">bar_chart</i>
                <h5 class="mt-3">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Dashboard</h5>
                <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
             </div>
          </div>
        </div>

        <div id="sec-pr" class="content-section">
          <h4 class="text-primary mb-4 fw-bold"><i class="material-icons align-middle">campaign</i> ‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</h4>
          <div id="prCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="0" class="active"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="1"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="2"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="3"></button>
              <button type="button" data-bs-target="#prCarousel" data-bs-slide-to="4"></button>
            </div>
            <div class="carousel-inner">
              <div class="carousel-item active" data-bs-interval="4000"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Doi_Suthep_02.jpg/1280px-Doi_Suthep_02.jpg" class="d-block w-100"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://thailandtourismdirectory.go.th/assets/upload/2018/01/22/2018012216262947119e830f576313.jpg" class="d-block w-100"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Chiang_Mai_Night_Bazaar.jpg/1280px-Chiang_Mai_Night_Bazaar.jpg" class="d-block w-100"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Royal_Park_Rajapruek.jpg/1280px-Royal_Park_Rajapruek.jpg" class="d-block w-100"></div>
              <div class="carousel-item" data-bs-interval="4000"><img src="https://via.placeholder.com/1200x600/0d6efd/ffffff?text=PR+Space+5" class="d-block w-100"></div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#prCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
            <button class="carousel-control-next" type="button" data-bs-target="#prCarousel" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
          </div>
        </div>
      </div>

      <div id="page-docs" style="display:none;">
        <div class="content-section">
          <h3 class="section-header">üìÇ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h3>
          <div id="adminDocPanel" class="admin-controls mb-4">
             <div class="d-flex justify-content-between align-items-center mb-3">
               <h5 class="fw-bold m-0"><i class="material-icons align-middle">post_add</i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏•‡∏¥‡∏á‡∏Å‡πå</h5>
               <div>
                 <button id="btnCancelEdit" class="btn btn-sm btn-secondary me-2" style="display:none;" onclick="cancelEditDoc()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                 <button class="btn btn-sm btn-danger fw-bold" onclick="logoutSystem()"><i class="material-icons align-middle fs-6">logout</i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
               </div>
             </div>
             <form onsubmit="submitDocument(event)">
                <input type="hidden" id="doc_id" value="">
                <div class="mb-2"><input type="text" class="form-control" id="doc_title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ / ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠" required></div>
                <div class="mb-2"><input type="text" class="form-control" id="doc_desc" placeholder="‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"></div>
                <div class="row g-2">
                   <div class="col-md-9"><input type="text" class="form-control" id="doc_link" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå" required></div>
                   <div class="col-md-3"><button type="submit" id="btnSaveDoc" class="btn btn-success w-100 fw-bold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>
                </div>
             </form>
          </div>
          <div id="docListContainer" class="list-group list-group-flush">
             <div class="text-center py-5 text-muted"><div class="spinner-border text-primary mb-2" role="status"></div><div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div></div>
          </div>
        </div>
      </div>

      <div id="page-calendar" style="display:none;">
        <div class="content-section border-0 bg-transparent p-0 mb-4 shadow-none">
          <h2 class="text-primary fw-bold"><i class="material-icons align-middle fs-2">calendar_month</i> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h2>
          <p class="text-muted">‡∏£‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        </div>
        
        <div class="alert alert-info shadow-sm" role="alert">
          <i class="material-icons align-middle me-2">info</i> 
          ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà
        </div>

        <div class="card shadow border-0 overflow-hidden">
           <iframe src="http://164.115.44.24/cmbase/public/calendar" 
                   style="width: 100%; height: 850px; border: none;" 
                   title="‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà">
           </iframe>
        </div>
        
        <div class="text-center mt-3">
           <a href="http://164.115.44.24/cmbase/public/calendar" target="_blank" class="btn btn-outline-secondary btn-sm">
             <i class="material-icons align-middle fs-6">open_in_new</i> ‡∏´‡∏≤‡∏Å‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
           </a>
        </div>
      </div>

      <div id="page-qa" style="display:none;">
        <div class="content-section">
          <h3 class="section-header">‚ùì ‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö (Q&A)</h3>
          <div class="accordion accordion-flush" id="accQA">
            <div class="accordion-item border rounded mb-3 shadow-sm">
              <h2 class="accordion-header"><button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#qa1">üìå ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</button></h2>
              <div id="qa1" class="accordion-collapse collapse show"><div class="accordion-body text-muted bg-light">‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏à‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏†‡∏≤‡∏Ñ‡∏™‡πà‡∏ß‡∏ô</div></div>
            </div>
            <div class="accordion-item border rounded mb-3 shadow-sm">
              <h2 class="accordion-header"><button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#qa2">üìÖ ‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏°‡∏µ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏µ‡πà‡∏õ‡∏µ?</button></h2>
              <div id="qa2" class="accordion-collapse collapse"><div class="accordion-body text-muted bg-light">‡πÅ‡∏ú‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏â‡∏ö‡∏±‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏õ‡∏µ (‡∏û.‡∏®. 2566 - 2570) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô</div></div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <footer class="main-footer container-fluid p-0">
    <div class="row m-0">
      <div class="col-lg-4 mb-4 mb-lg-0">
        <h5 class="footer-title">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h5>
        <p class="mb-2 text-white-50">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</p>
        <p class="small opacity-50">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£ ‡∏ä‡∏±‡πâ‡∏ô 3 ‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏ñ‡∏ô‡∏ô‡πÇ‡∏ä‡∏ï‡∏ô‡∏≤ <br>‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà 50300</p>
        <div id="footerCopyright" class="admin-trigger" onclick="loginToggle()">¬© 2026 All Rights Reserved.</div>
      </div>
      <div class="col-lg-4 mb-4 mb-lg-0">
        <h5 class="footer-title">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h5>
        <ul class="list-unstyled">
          <li class="mb-3 d-flex"><span class="me-2">üìû</span> <span>053-112-703</span></li>
          <li class="mb-3 d-flex"><span class="me-2">üìß</span> <span>plancm.700@gmail.com</span></li>
          <li class="mb-3 d-flex"><span class="me-2">üïí</span> <span>‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå (08.30 - 16.30 ‡∏ô.)</span></li>
          <li class="mb-3 d-flex"><span class="me-2">üåê</span> <a href="http://www.chiangmai.go.th" class="text-decoration-none text-white-50">www.chiangmai.go.th</a></li>
        </ul>
      </div>
      <div class="col-lg-4">
        <h5 class="footer-title">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</h5>
        <div class="map-container mb-3" style="height: 200px; background: #333;">
          <iframe src="https://maps.google.com/maps?q=%E0%B8%A8%E0%B8%B2%E0%B8%A5%E0%B8%B2%E0%B8%81%E0%B8%A5%E0%B8%B2%E0%B8%87%E0%B8%88%E0%B8%B1%E0%B8%87%E0%B8%AB%E0%B8%A7%E0%B8%B1%E0%B8%94%E0%B9%80%E0%B8%8A%E0%B8%B5%E0%B8%A2%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88&t=&z=15&ie=UTF8&iwloc=&output=embed" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
        <a href="https://www.google.com/maps/search/?api=1&query=‡∏®‡∏≤‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà" target="_blank" class="btn btn-outline-light btn-sm w-100"><i class="material-icons align-middle fs-6">near_me</i> ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á via Google Maps</a>
      </div>
    </div>
  </footer>

  <div class="modal fade" id="formModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title fw-bold" id="formTitle">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-4">
          <form onsubmit="submitForm(event)">
            <input type="hidden" id="f_topic_type">
            <div class="mb-3"><label class="fw-bold form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="text-danger">*</span></label><input class="form-control" id="f_name" required></div>
            <div class="mb-3"><label class="fw-bold form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label><input class="form-control" id="f_contact"></div>
            <div class="mb-3" id="topicSelectDiv">
               <label class="fw-bold form-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏õ‡∏±‡∏ç‡∏´‡∏≤ <span class="text-danger">*</span></label>
               <select class="form-select" id="f_topic_select">
                  <option value="" selected disabled>-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                  <option>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</option><option>‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°/‡∏°‡∏•‡∏û‡∏¥‡∏©</option><option>‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à/‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</option><option>‡∏™‡∏±‡∏á‡∏Ñ‡∏°/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</option><option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
               </select>
            </div>
            <div class="mb-3"><label class="fw-bold form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î <span class="text-danger">*</span></label><textarea class="form-control" id="f_detail" rows="5" required></textarea></div>
            <div class="d-grid"><button class="btn btn-success py-2 fw-bold shadow-sm">üöÄ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button></div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    let docs = [];
    let isAdmin = false;
    let form1Open = true; 
    let form2Open = true;

    function initSystem() { 
      fetchDocs(); 
      checkSettings(); 
    }
    
    // Sidebar Toggle
    function toggleSidebar() {
       let sidebar = document.getElementById('sidebar');
       let overlay = document.getElementById('sidebarOverlay');
       sidebar.classList.toggle('active');
       overlay.classList.toggle('active');
    }

    function showPage(id) {
      ['home','docs','calendar','qa'].forEach(p => document.getElementById('page-'+p).style.display = 'none');
      document.getElementById('page-'+id).style.display = 'block';
      document.querySelectorAll('.nav-link-main').forEach(el => el.classList.remove('active'));
      document.getElementById('menu-'+id).classList.add('active');
      if(id === 'docs') renderDocs(); 
      window.scrollTo(0,0);
      if(window.innerWidth <= 768) {
         document.getElementById('sidebar').classList.remove('active');
         document.getElementById('sidebarOverlay').classList.remove('active');
      }
    }
    
    function scrollToId(id) {
       showPage('home');
       setTimeout(() => { document.getElementById(id).scrollIntoView({behavior: 'smooth', block: 'start'}); }, 100);
       if(window.innerWidth <= 768) toggleSidebar();
    }

    // --- DOCS SYSTEM ---
    function fetchDocs() { fetch(SCRIPT_URL + '?action=getDocs').then(r => r.json()).then(data => { docs = data; if(document.getElementById('page-docs').style.display === 'block') renderDocs(); }).catch(e => console.error(e)); }
    function renderDocs() {
      let html = '';
      if(docs.length === 0) { html = '<div class="text-center text-muted py-5">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</div>'; } 
      else {
        docs.forEach(doc => {
          let icon = 'description', color = 'text-primary';
          if(doc.link.includes('drive')) { icon = 'add_to_drive'; color = 'text-success'; } 
          else if(doc.link.includes('.pdf')) { icon = 'picture_as_pdf'; color = 'text-danger'; }
          let dateStr = "‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà: " + formatDate(doc.created);
          if(doc.updated && doc.updated !== doc.created) { dateStr += ` | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ${formatDate(doc.updated)}`; }
          
          let editBtn = isAdmin ? `<button class="btn btn-sm btn-outline-warning ms-2" onclick="editDoc('${doc.id}')">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>` : '';
          let deleteBtn = isAdmin ? `<button class="btn btn-sm btn-outline-danger ms-2" onclick="deleteDoc('${doc.id}')">‡∏•‡∏ö</button>` : '';

          html += `<div class="list-group-item list-group-item-action d-flex align-items-start py-4 px-3 border-bottom"><i class="material-icons fs-2 me-4 mt-1 ${color}">${icon}</i><div class="flex-grow-1"><a href="${doc.link}" target="_blank" class="text-decoration-none text-dark"><h5 class="mb-1 fw-bold">${doc.title}</h5><div class="text-muted small mb-2">${doc.desc || "-"}</div><small class="text-secondary">${dateStr}</small></a></div><div class="d-flex align-items-center">${editBtn} ${deleteBtn}</div></div>`;
        });
      }
      document.getElementById('docListContainer').innerHTML = html;
    }
    function formatDate(isoStr) { if(!isoStr) return ""; let d = new Date(isoStr); return d.toLocaleDateString('th-TH') + ' ' + d.toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'}); }
    
    function editDoc(id) {
       let doc = docs.find(d => d.id === id); if(!doc) return;
       document.getElementById('doc_id').value = doc.id;
       document.getElementById('doc_title').value = doc.title;
       document.getElementById('doc_desc').value = doc.desc;
       document.getElementById('doc_link').value = doc.link;
       document.getElementById('btnSaveDoc').innerText = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
       document.getElementById('btnSaveDoc').classList.replace('btn-success', 'btn-warning');
       document.getElementById('btnCancelEdit').style.display = 'inline-block';
       document.getElementById('adminDocPanel').scrollIntoView({behavior: 'smooth'});
    }
    function cancelEditDoc() {
       document.getElementById('adminDocPanel').querySelector('form').reset();
       document.getElementById('doc_id').value = '';
       document.getElementById('btnSaveDoc').innerText = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
       document.getElementById('btnSaveDoc').classList.replace('btn-warning', 'btn-success');
       document.getElementById('btnCancelEdit').style.display = 'none';
    }
    function submitDocument(e) {
      e.preventDefault();
      let id = getVal('doc_id'), title = getVal('doc_title'), desc = getVal('doc_desc'), link = getVal('doc_link');
      let isEdit = (id !== "");
      if(isEdit) {
         let idx = docs.findIndex(d => d.id === id);
         if(idx !== -1) { docs[idx].title = title; docs[idx].desc = desc; docs[idx].link = link; docs[idx].updated = new Date().toISOString(); }
      } else {
         let newId = 'TEMP_' + Date.now(); 
         docs.unshift({ title: title, desc: desc, link: link, id: newId, type: 'link', created: new Date().toISOString() });
      }
      renderDocs(); cancelEditDoc();
      Swal.fire({ icon: 'success', title: isEdit ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß', timer: 1500, showConfirmButton: false });
      fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'saveDoc', id: id, title: title, desc: desc, link: link, type: 'link' }) }).then(() => fetchDocs());
    }
    function deleteDoc(id) {
      if(!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) return;
      docs = docs.filter(d => d.id !== id); renderDocs();
      fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'deleteDoc', id: id }) });
    }

    // --- Core Functions ---
    function checkSettings() { fetch(SCRIPT_URL + '?action=getSettings').then(r => r.json()).then(data => { form1Open = (data.form1 === 'OPEN'); form2Open = (data.form2 === 'OPEN'); updateUI(); }); }
    function toggleForm(num) {
       let isChecked = document.getElementById('swForm'+num).checked;
       let status = isChecked ? 'OPEN' : 'CLOSED';
       let key = 'FORM_' + num + '_STATUS';
       postData({ action: 'toggleForm', key: key, status: status }, () => {
          if(num===1) form1Open = isChecked; if(num===2) form2Open = isChecked; updateUI();
          const Toast = Swal.mixin({toast: true, position: 'top-end', showConfirmButton: false, timer: 3000});
          Toast.fire({icon: 'success', title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'});
       });
    }
    function updateUI() {
       let b1 = document.getElementById('banner1'), badge1 = document.getElementById('badge1'), st1 = document.getElementById('statusText1');
       if(form1Open) { b1.classList.remove('closed'); badge1.style.display = 'block'; st1.className = "banner-desc mt-2 badge bg-white text-danger fs-6"; st1.innerText = "üìÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö: 1 ‡∏°.‡∏Ñ. 68 - 31 ‡∏ò.‡∏Ñ. 68"; } 
       else { b1.classList.add('closed'); badge1.style.display = 'none'; st1.className = "banner-desc mt-2 badge bg-secondary text-white fs-6"; st1.innerText = "‚õî ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á"; }
       
       let b2 = document.getElementById('banner2'), badge2 = document.getElementById('badge2'), st2 = document.getElementById('statusText2');
       if(form2Open) { b2.classList.remove('closed'); badge2.style.display = 'block'; st2.className = "banner-desc mt-2 badge bg-danger text-white fs-6"; st2.innerText = "üìÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö: 1 ‡∏Å.‡∏û. 68 - 28 ‡∏Å.‡∏û. 68"; } 
       else { b2.classList.add('closed'); badge2.style.display = 'none'; st2.className = "banner-desc mt-2 badge bg-secondary text-white fs-6"; st2.innerText = "‚õî ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß"; }
       
       if(document.getElementById('swForm1')) document.getElementById('swForm1').checked = form1Open;
       if(document.getElementById('swForm2')) document.getElementById('swForm2').checked = form2Open;
    }
    function handleBannerClick(num) {
       let isOpen = (num === 1) ? form1Open : form2Open;
       if (isOpen) { openFormModal(num === 1 ? 'general' : 'special'); } 
       else { Swal.fire({ icon: 'warning', title: '‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', text: '‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à', confirmButtonText: '‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö', confirmButtonColor: '#636e72' }); }
    }
    function openFormModal(type) {
       var modalForm = new bootstrap.Modal(document.getElementById('formModal'));
       let title = (type === 'general') ? '‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ' : '‡πÄ‡∏™‡∏ô‡∏≠‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢: ‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà 2030';
       document.getElementById('formTitle').innerText = title;
       document.getElementById('f_topic_type').value = title;
       if(type === 'general') { document.getElementById('topicSelectDiv').style.display = 'block'; } else { document.getElementById('topicSelectDiv').style.display = 'none'; }
       modalForm.show();
    }
    function submitForm(e) {
      e.preventDefault();
      let btn = e.target.querySelector('button'); let oldText = btn.innerText;
      btn.disabled = true; btn.innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
      let topicVal = document.getElementById('f_topic_type').value;
      if(topicVal === '‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ') {
         let select = document.getElementById('f_topic_select');
         if(select.value === "") { Swal.fire('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà'); btn.disabled = false; btn.innerText = oldText; return; }
         topicVal = select.value;
      }
      let data = { action:'saveForm', name: getVal('f_name'), contact: getVal('f_contact'), detail: getVal('f_detail'), topic: topicVal };
      postData(data, () => { Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß','success'); document.getElementById('formModal').querySelector('form').reset(); bootstrap.Modal.getInstance(document.getElementById('formModal')).hide(); btn.disabled = false; btn.innerText = oldText; });
    }
    
    // Login System
    function loginToggle() {
      if(isAdmin) return logoutSystem();
      Swal.fire({ title: '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà', input: 'password', confirmButtonText: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö' }).then(res => {
        if(!res.value) return;
        postData({action: 'login', password: res.value}, (data) => {
           if(data.status === 'SUCCESS') { setAdminMode(true); Swal.fire({icon: 'success', title: '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö', timer: 1500, showConfirmButton: false}); } 
           else { Swal.fire({icon: 'error', title: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'}); }
        });
      });
    }
    function logoutSystem() {
      Swal.fire({ title: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?', icon: 'question', showCancelButton: true, confirmButtonText: '‡πÉ‡∏ä‡πà', cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' }).then((res) => {
        if(res.isConfirmed) { setAdminMode(false); Swal.fire({icon: 'success', title: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß', timer: 1500, showConfirmButton: false}); }
      });
    }
    function setAdminMode(status) {
       isAdmin = status;
       if(status) {
          document.getElementById('adminHomePanel').style.display='block';
          document.getElementById('adminDocPanel').style.display='block';
          document.getElementById('sidebarLogoutArea').style.display='block';
       } else {
          document.getElementById('adminHomePanel').style.display='none';
          document.getElementById('adminDocPanel').style.display='none';
          document.getElementById('sidebarLogoutArea').style.display='none';
       }
       updateUI(); renderDocs(); 
       if(document.getElementById('swForm1')) document.getElementById('swForm1').checked = form1Open;
       if(document.getElementById('swForm2')) document.getElementById('swForm2').checked = form2Open;
    }
    function postData(data, callback) { fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(data) }).then(r => r.json()).then(d => callback(d)).catch(e => console.error(e)); }
    function getVal(id) { return document.getElementById(id).value; }
  </script>
</body>
</html>
